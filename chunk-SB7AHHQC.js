import{c as H,d as J,e as K,f as Q,g as X,h as Y,i as Z,j as $,n as ee,o as te,p as ie,r as ne}from"./chunk-V4S5BHXF.js";import{a as oe}from"./chunk-IY34DK4E.js";import{Ab as C,Bb as S,Bc as re,Ca as c,Db as G,Eb as N,Fb as O,Ha as F,Kb as f,Lb as v,Ma as P,Mb as V,Qa as _,Xa as m,Za as j,aa as p,ba as u,db as i,eb as t,fb as x,gc as z,hc as A,ic as L,jb as y,kb as g,lb as d,pb as B,sc as q,tc as U,uc as D,vb as o,wb as b,xb as h,ya as R,yb as W,zb as w}from"./chunk-YGAPY4LI.js";import"./chunk-LMZWYZYD.js";import{a as I,b as k,h as ae,j as E}from"./chunk-K4ALXBGI.js";var M=ae(oe());var ce=(a,r)=>({"text-green-600":a,"text-red-600":r}),le=a=>({"bg-gray-50":a}),de=()=>({standalone:!0});function se(a,r){if(a&1&&(i(0,"div",39),x(1,"img",40),t()),a&2){let e=d().$implicit;c(),B("alt","Imagen de ",e.nombre,""),m("src",e.imagen_url,R)}}function me(a,r){if(a&1&&(i(0,"tr",41)(1,"td",42),o(2),t(),i(3,"td",42),o(4),t(),i(5,"td",42),o(6),f(7,"currency"),t()()),a&2){let e=r.$implicit,l=r.even;m("ngClass",N(6,le,l)),c(2),b(e.nombre),c(2),b(e.cantidad),c(2),b(v(7,4,e.precio_unitario))}}function pe(a,r){if(a&1&&(i(0,"div",43),o(1," Ganancia de "),i(2,"span",44),o(3),f(4,"number"),t(),o(5," sobre el costo "),t()),a&2){let e=d().$implicit;c(3),h("",V(4,1,e.porcentajeGanancia,"1.0-0"),"%")}}function ue(a,r){if(a&1&&(i(0,"div",45),o(1," P\xE9rdida de "),i(2,"span",44),o(3),f(4,"number"),t(),o(5," sobre el costo "),t()),a&2){let e=d().$implicit;c(3),h("",V(4,1,e.porcentajeGanancia,"1.0-0"),"%")}}function ge(a,r){if(a&1){let e=y();i(0,"div",16)(1,"div",17)(2,"h3",18),o(3),t(),i(4,"div",19)(5,"button",20),g("click",function(){let n=p(e).$implicit,s=d();return u(s.abrirModalEditarReceta(n))}),x(6,"i",21),t()()(),_(7,se,2,3,"div",22),i(8,"div",23)(9,"table",24)(10,"thead",25)(11,"tr")(12,"th",26),o(13,"Ingrediente"),t(),i(14,"th",26),o(15,"Cant."),t(),i(16,"th",26),o(17,"Precio"),t()()(),i(18,"tbody"),_(19,me,8,8,"tr",27),i(20,"tr",28)(21,"td",29),o(22,"Total Costo"),t(),i(23,"td",30),o(24),f(25,"currency"),t()()()()(),i(26,"div",31)(27,"div",32)(28,"span",33),o(29,"Costo de Preparaci\xF3n:"),t(),i(30,"span",34),o(31),f(32,"currency"),t()(),i(33,"div",32)(34,"span",33),o(35,"Precio de Venta:"),t(),i(36,"span",35),o(37),f(38,"currency"),t()(),i(39,"div",32)(40,"span",33),o(41,"Ganancia:"),t(),i(42,"span",36),o(43),f(44,"currency"),t()(),_(45,pe,6,4,"div",37)(46,ue,6,4,"div",38),t()()}if(a&2){let e=r.$implicit;c(3),b(e.nombre),c(4),m("ngIf",e.imagen_url),c(12),m("ngForOf",e.ingredientes),c(5),b(v(25,10,e.precio_preparacion)),c(7),b(v(32,12,e.precio_preparacion)),c(6),b(v(38,14,e.precio_venta)),c(5),m("ngClass",O(18,ce,e.ganancia>0,e.ganancia<0)),c(),h(" ",v(44,16,e.ganancia)," "),c(2),m("ngIf",e.ganancia>0),c(),m("ngIf",e.ganancia<0)}}function _e(a,r){if(a&1){let e=y();i(0,"button",86),g("click",function(){p(e);let n=d(3);return u(n.eliminarImagen())}),x(1,"i",87),t()}}function xe(a,r){if(a&1&&(i(0,"div",83)(1,"div",7),x(2,"img",84),_(3,_e,2,0,"button",85),t()()),a&2){let e=d(2);c(2),m("src",e.previewImagenUrl||e.receta.imagen_url,R),c(),m("ngIf",e.previewImagenUrl||e.receta.imagen_url)}}function be(a,r){if(a&1){let e=y();i(0,"span",88),g("click",function(){p(e);let n=d(2);return n.buscador="",u(n.filtrarIngredientes())}),x(1,"i",89),t()}}function fe(a,r){if(a&1&&(i(0,"span",43),o(1),t()),a&2){let e=d().$implicit;c(),h(" Stock: ",e.stock_actual," ")}}function ve(a,r){a&1&&(i(0,"span",45),o(1," Sin stock "),t())}function he(a,r){if(a&1){let e=y();i(0,"div",92)(1,"div",93)(2,"span",74),o(3),t(),i(4,"span",94),o(5),f(6,"currency"),t(),_(7,fe,2,1,"span",37)(8,ve,2,0,"span",38),t(),i(9,"button",95),g("click",function(){let n=p(e).$implicit,s=d(3);return u(s.mostrarInputCantidad(n))}),o(10," Agregar "),t()()}if(a&2){let e=r.$implicit;c(3),b(e.nombre),c(2),h("(",v(6,5,e.costo_unitario),")"),c(2),m("ngIf",e.stock_actual>0),c(),m("ngIf",e.stock_actual<=0),c(),m("disabled",e.stock_actual<=0)}}function ye(a,r){if(a&1&&(i(0,"div",90),_(1,he,11,7,"div",91),t()),a&2){let e=d(2);c(),m("ngForOf",e.productosFiltrados)}}function we(a,r){a&1&&(i(0,"div",96),o(1," No se encontraron ingredientes "),t())}function Ce(a,r){if(a&1&&(i(0,"p",63),o(1),t()),a&2){let e=d(3);c(),h(" Stock disponible: ",e.ingredienteSeleccionado.stock_actual," ")}}function Se(a,r){a&1&&(i(0,"p",108),o(1," Este producto no tiene stock disponible "),t())}function Ee(a,r){if(a&1){let e=y();i(0,"div",97)(1,"div",98)(2,"span",99),o(3),t(),i(4,"button",100),g("click",function(){p(e);let n=d(2);return u(n.ingredienteSeleccionado=null)}),x(5,"i",89),t()(),i(6,"div",101)(7,"div",102)(8,"label",103),o(9,"Cantidad *"),t(),i(10,"input",104),S("ngModelChange",function(n){p(e);let s=d(2);return C(s.cantidadSeleccionada,n)||(s.cantidadSeleccionada=n),u(n)}),t()(),i(11,"button",105),g("click",function(){p(e);let n=d(2);return u(n.agregarIngrediente())}),o(12," Confirmar "),t()(),_(13,Ce,2,1,"p",106)(14,Se,2,0,"p",107),t()}if(a&2){let e=d(2);c(3),h("Agregando: ",e.ingredienteSeleccionado.nombre,""),c(7),w("ngModel",e.cantidadSeleccionada),m("max",e.ingredienteSeleccionado.stock_actual),c(3),m("ngIf",e.ingredienteSeleccionado.stock_actual>0),c(),m("ngIf",e.ingredienteSeleccionado.stock_actual<=0)}}function Ie(a,r){if(a&1){let e=y();i(0,"li",112)(1,"div")(2,"span",99),o(3),t(),i(4,"span",113),o(5),f(6,"currency"),t()(),i(7,"div",114)(8,"span",99),o(9),f(10,"currency"),t(),i(11,"button",115),g("click",function(){let n=p(e).index,s=d(3);return u(s.eliminarIngrediente(n))}),x(12,"i",116),t()()()}if(a&2){let e=r.$implicit;c(3),b(e.nombre),c(2),W("(",e.cantidad," x ",v(6,4,e.precio_unitario),")"),c(4),b(v(10,6,e.cantidad*e.precio_unitario))}}function Re(a,r){if(a&1&&(i(0,"div",109)(1,"ul",110),_(2,Ie,13,8,"li",111),t()()),a&2){let e=d(2);c(2),m("ngForOf",e.receta.ingredientes)}}function Me(a,r){a&1&&(i(0,"div",117),o(1," No hay ingredientes seleccionados "),t())}function ke(a,r){if(a&1){let e=y();i(0,"div",46)(1,"div",47)(2,"button",48),g("click",function(){p(e);let n=d();return u(n.cerrarModalReceta())}),x(3,"i",49),t(),i(4,"div",50)(5,"h2",51),o(6),t()(),i(7,"form",52),g("submit",function(){p(e);let n=d();return u(n.guardarReceta())}),i(8,"div",53)(9,"div",54)(10,"label",55),o(11,"Nombre de la receta *"),t(),i(12,"input",56),S("ngModelChange",function(n){p(e);let s=d();return C(s.receta.nombre,n)||(s.receta.nombre=n),u(n)}),t()(),i(13,"div",54)(14,"label",57),o(15,"Imagen de la receta"),t(),i(16,"div",58)(17,"input",59),g("change",function(n){p(e);let s=d();return u(s.onImagenChange(n))}),t(),i(18,"div",60),x(19,"i",61),i(20,"p",62),o(21),t(),i(22,"p",63),o(23,"Formatos: JPG, PNG (Max. 2MB)"),t()()(),_(24,xe,4,2,"div",64),t(),i(25,"div",54)(26,"label",65),o(27,"Precio de Venta *"),t(),i(28,"input",66),S("ngModelChange",function(n){p(e);let s=d();return C(s.receta.precio_venta,n)||(s.receta.precio_venta=n),u(n)}),g("ngModelChange",function(){p(e);let n=d();return u(n.calcularGanancia())}),t()(),i(29,"div",54)(30,"label",67),o(31,"Buscar Ingredientes *"),t(),i(32,"div",7)(33,"input",68),S("ngModelChange",function(n){p(e);let s=d();return C(s.buscador,n)||(s.buscador=n),u(n)}),g("input",function(){p(e);let n=d();return u(n.filtrarIngredientes())}),t(),_(34,be,2,0,"span",69),t()(),_(35,ye,2,1,"div",70)(36,we,2,0,"div",71)(37,Ee,15,5,"div",72),i(38,"div",73)(39,"div",32)(40,"h3",74),o(41,"Ingredientes Seleccionados:"),t(),i(42,"span",75),o(43),f(44,"currency"),t()(),_(45,Re,3,1,"div",76)(46,Me,2,0,"div",77),t(),i(47,"div",73)(48,"div",32)(49,"span",33),o(50,"Precio de Preparaci\xF3n:"),t(),i(51,"span",75),o(52),f(53,"currency"),t()(),i(54,"div",78)(55,"span",33),o(56,"Ganancia:"),t(),i(57,"span",79),o(58),f(59,"currency"),t()()(),i(60,"div",80)(61,"button",81),g("click",function(){p(e);let n=d();return u(n.cerrarModalReceta())}),o(62," Cancelar "),t(),i(63,"button",82),o(64),t()()()()()()}if(a&2){let e=d();c(6),h("",e.receta.id?"Editar":"Agregar"," Receta"),c(6),w("ngModel",e.receta.nombre),c(9),h(" ",e.nuevaImagenFile?e.nuevaImagenFile.name:e.receta.imagen_url?"Cambiar imagen":"Haz clic para subir una imagen"," "),c(3),m("ngIf",e.previewImagenUrl||e.receta.imagen_url),c(4),w("ngModel",e.receta.precio_venta),c(5),w("ngModel",e.buscador),c(),m("ngIf",e.buscador),c(),m("ngIf",e.productosFiltrados.length>0),c(),m("ngIf",e.productosFiltrados.length===0),c(),m("ngIf",e.ingredienteSeleccionado),c(6),h(" Total: ",v(44,17,e.receta.precio_preparacion)," "),c(2),m("ngIf",e.receta.ingredientes.length>0),c(),m("ngIf",e.receta.ingredientes.length===0),c(6),b(v(53,19,e.receta.precio_preparacion)),c(6),b(v(59,21,e.receta.ganancia)),c(5),m("disabled",e.receta.ingredientes.length===0||!e.receta.nombre||!e.receta.precio_venta),c(),h(" ",e.receta.id?"Actualizar":"Guardar"," Receta ")}}function Ve(a,r){if(a&1){let e=y();i(0,"div",83)(1,"div",7),x(2,"img",154),i(3,"button",155),g("click",function(){p(e);let n=d(2);return u(n.eliminarImagen())}),x(4,"i",87),t()()()}if(a&2){let e=d(2);c(2),m("src",e.previewImagenUrl||e.receta.imagen_url,R)}}function Te(a,r){a&1&&(i(0,"tr")(1,"td",156),o(2,"No se encontraron ingredientes"),t()())}function Fe(a,r){if(a&1){let e=y();i(0,"tr",157)(1,"td",158)(2,"input",159),S("ngModelChange",function(n){p(e);let s=d(2);return C(s.ingredienteSeleccionado,n)||(s.ingredienteSeleccionado=n),u(n)}),t()(),i(3,"td",160),o(4),t(),i(5,"td",160),o(6),f(7,"currency"),t()()}if(a&2){let e=r.$implicit,l=d(2);j("bg-blue-50",(l.ingredienteSeleccionado==null?null:l.ingredienteSeleccionado.id)===e.id),c(2),m("value",e),w("ngModel",l.ingredienteSeleccionado),m("ngModelOptions",G(9,de)),c(2),b(e.nombre),c(2),b(v(7,7,e.costo_unitario))}}function Pe(a,r){if(a&1){let e=y();i(0,"li",163)(1,"div",164)(2,"span",102),o(3),t(),i(4,"input",165),S("ngModelChange",function(n){let s=p(e).$implicit;return C(s.cantidad,n)||(s.cantidad=n),u(n)}),g("ngModelChange",function(){p(e);let n=d(3);return u(n.calcularGanancia())}),t(),i(5,"span",166),o(6),f(7,"currency"),t(),i(8,"button",167),g("click",function(){let n=p(e).index,s=d(3);return u(s.eliminarIngrediente(n))}),o(9,"\u274C"),t()()()}if(a&2){let e=r.$implicit;c(3),b(e.nombre),c(),w("ngModel",e.cantidad),m("name","cantidad_"+e.producto_id),c(2),b(v(7,4,e.precio_unitario))}}function je(a,r){if(a&1&&(i(0,"div",161)(1,"ul"),_(2,Pe,10,6,"li",162),t()()),a&2){let e=d(2);c(2),m("ngForOf",e.receta.ingredientes)}}function Be(a,r){a&1&&(i(0,"div",168),o(1,"No hay ingredientes."),t())}function We(a,r){if(a&1){let e=y();i(0,"div",118)(1,"div",119)(2,"button",48),g("click",function(){p(e);let n=d();return u(n.cerrarModalEditarReceta())}),x(3,"i",49),t(),i(4,"div",50)(5,"h2",51),o(6,"Editar Receta"),t()(),i(7,"form",120),g("submit",function(){p(e);let n=d();return u(n.actualizarReceta())}),i(8,"div",121)(9,"label",122),o(10,"Nombre:"),t(),i(11,"input",123),S("ngModelChange",function(n){p(e);let s=d();return C(s.receta.nombre,n)||(s.receta.nombre=n),u(n)}),t(),i(12,"div",73)(13,"label",124),o(14,"Imagen de la receta"),t(),i(15,"div",125)(16,"input",126),g("change",function(n){p(e);let s=d();return u(s.onImagenChange(n))}),t(),i(17,"div",60),x(18,"i",61),i(19,"p",62),o(20),t(),i(21,"p",63),o(22,"Formatos: JPG, PNG (Max. 5MB)"),t()()(),_(23,Ve,5,1,"div",64),t(),i(24,"div",127)(25,"h3",128),o(26,"Agregar Ingrediente"),t(),i(27,"div",39)(28,"input",129),S("ngModelChange",function(n){p(e);let s=d();return C(s.buscador,n)||(s.buscador=n),u(n)}),g("input",function(){p(e);let n=d();return u(n.filtrarIngredientes())}),t()(),i(29,"div",130)(30,"table",131)(31,"thead",132)(32,"tr")(33,"th",133),o(34,"Seleccionar"),t(),i(35,"th",133),o(36,"Nombre"),t(),i(37,"th",133),o(38,"Precio Unitario"),t()()(),i(39,"tbody",134),_(40,Te,3,0,"tr",135)(41,Fe,8,10,"tr",136),t()()(),i(42,"div",137)(43,"div",102)(44,"label",138),o(45,"Cantidad"),t(),i(46,"input",139),S("ngModelChange",function(n){p(e);let s=d();return C(s.cantidadSeleccionada,n)||(s.cantidadSeleccionada=n),u(n)}),t()(),i(47,"button",140),g("click",function(){p(e);let n=d();return u(n.agregarIngrediente())}),o(48,"Agregar Ingrediente"),t()()(),i(49,"div",141)(50,"h3",142),o(51,"Ingredientes:"),t(),_(52,je,3,1,"div",143)(53,Be,2,0,"div",144),t(),i(54,"div",141)(55,"label",145),o(56,"Precio de Preparaci\xF3n:"),t(),x(57,"input",146),i(58,"div",141)(59,"label",147),o(60,"Precio de Venta:"),t(),i(61,"input",148),S("ngModelChange",function(n){p(e);let s=d();return C(s.receta.precio_venta,n)||(s.receta.precio_venta=n),u(n)}),g("ngModelChange",function(){p(e);let n=d();return u(n.calcularGanancia())}),t()(),i(62,"label",149),o(63,"Ganancia:"),t(),x(64,"input",150),t(),i(65,"div",151)(66,"button",152),g("click",function(){p(e);let n=d();return u(n.cerrarModalEditarReceta())}),o(67,"Cancelar"),t(),i(68,"button",153),o(69,"Guardar Cambios"),t()()()()()()}if(a&2){let e=d();c(11),w("ngModel",e.receta.nombre),c(9),h(" ",e.nuevaImagenFile?e.nuevaImagenFile.name:e.receta.imagen_url?"Imagen actual - Click para cambiar":"Haz clic para subir una imagen"," "),c(3),m("ngIf",e.previewImagenUrl||e.receta.imagen_url),c(5),w("ngModel",e.buscador),c(12),m("ngIf",e.productosFiltrados.length===0),c(),m("ngForOf",e.productosFiltrados),c(5),w("ngModel",e.cantidadSeleccionada),c(6),m("ngIf",e.receta.ingredientes.length>0),c(),m("ngIf",e.receta.ingredientes.length===0),c(4),m("value",e.receta.precio_preparacion),c(4),w("ngModel",e.receta.precio_venta),c(3),m("value",e.receta.ganancia)}}var T=class a{constructor(r){this.supabaseService=r}productos=[];productosFiltrados=[];buscador="";ingredienteSeleccionado=null;cantidadSeleccionada=1;recetaSeleccionada=null;productosDisponibles=[];receta={nombre:"",ingredientes:[],precio_preparacion:0,precio_venta:0,ganancia:0};recetas=[];recetaAEliminar=null;mostrarConfirmacionEliminar=!1;mostrarModalEditarReceta=!1;mostrarModalReceta=!1;cargando=!1;terminoBusquedaIngrediente="";productosFiltradosBusqueda=[];terminoBusquedaReceta="";recetasFiltradas=[];nuevaImagenFile;previewImagenUrl=null;ngOnInit(){return E(this,null,function*(){yield this.cargarProductos(),yield this.cargarRecetas()})}cargarProductos(){return E(this,null,function*(){try{this.cargando=!0,this.productos=yield this.supabaseService.obtenerProductos(),this.productosFiltrados=[...this.productos]}catch(r){console.error("Error cargando productos:",r)}finally{this.cargando=!1}})}abrirModalReceta(r){r?(this.receta=I({},r),this.previewImagenUrl=this.receta.imagen_url??null,this.nuevaImagenFile=void 0):this.resetearReceta(),this.mostrarModalReceta=!0}cerrarModalReceta(){this.mostrarModalReceta=!1,this.resetearReceta()}resetearReceta(){this.receta={nombre:"",ingredientes:[],precio_preparacion:0,precio_venta:0,ganancia:0},this.ingredienteSeleccionado=null,this.buscador="",this.productosFiltrados=[...this.productos]}filtrarIngredientes(){if(!this.buscador){this.productosFiltrados=[...this.productos];return}let r=this.buscador.toLowerCase();this.productosFiltrados=this.productos.filter(e=>e.nombre.toLowerCase().includes(r))}mostrarInputCantidad(r){this.ingredienteSeleccionado=r,this.cantidadSeleccionada=1}agregarIngrediente(){if(!this.ingredienteSeleccionado||this.cantidadSeleccionada<=0)return;let r=this.receta.ingredientes.findIndex(e=>e.producto_id===this.ingredienteSeleccionado?.id);r>=0?this.receta.ingredientes[r].cantidad+=this.cantidadSeleccionada:this.receta.ingredientes.push({producto_id:this.ingredienteSeleccionado.id,nombre:this.ingredienteSeleccionado.nombre,cantidad:this.cantidadSeleccionada,precio_unitario:this.ingredienteSeleccionado.costo_unitario}),this.calcularPrecioPreparacion(),this.ingredienteSeleccionado=null}onIngredienteSeleccionado(){this.cantidadSeleccionada=1}calcularPrecioPreparacion(){if(!this.receta.ingredientes||this.receta.ingredientes.length===0){this.receta.precio_preparacion=0;return}this.receta.precio_preparacion=this.receta.ingredientes.reduce((r,e)=>r+e.precio_unitario*e.cantidad,0)}guardarReceta(){return E(this,null,function*(){if(!(this.receta.ingredientes.length===0||!this.receta.nombre))try{this.cargando=!0,this.calcularPrecioPreparacion();let r={nombre:this.receta.nombre,ingredientes:this.receta.ingredientes,precio_preparacion:this.receta.precio_preparacion,imagen_url:this.receta.imagen_url,precio_venta:this.receta.precio_venta,ganancia:this.receta.ganancia};this.receta.id?yield this.supabaseService.actualizarReceta(this.receta.id,r,this.nuevaImagenFile):yield this.supabaseService.agregarReceta(r,this.nuevaImagenFile),this.cerrarModalReceta(),this.mostrarMensajeExito(),yield this.cargarRecetas(),this.nuevaImagenFile=void 0}catch(r){console.error("Error guardando receta:",r),this.mostrarMensajeError()}finally{this.cargando=!1}})}mostrarMensajeExito(){M.default.fire({title:"\xA1\xC9xito!",text:"La receta se ha guardado correctamente.",icon:"success",confirmButtonText:"Aceptar",timer:2e3})}mostrarMensajeError(){M.default.fire({title:"Error",text:"Hubo un problema al guardar la receta. Intenta nuevamente.",icon:"error",confirmButtonText:"Aceptar"})}onImagenChange(r){let e=r.target;if(e.files&&e.files[0]){this.nuevaImagenFile=e.files[0];let l=new FileReader;l.onload=n=>{this.previewImagenUrl=n.target?.result},l.readAsDataURL(this.nuevaImagenFile)}}eliminarImagen(){this.previewImagenUrl=null,this.nuevaImagenFile=void 0,this.receta.imagen_url&&(this.receta.imagen_url=null)}cargarRecetas(){return E(this,null,function*(){try{this.cargando=!0,this.recetas=yield this.supabaseService.obtenerRecetas(),this.recetas=this.recetas.map(r=>k(I({},r),{ingredientes:typeof r.ingredientes=="string"?JSON.parse(r.ingredientes):r.ingredientes})),this.recetas.forEach(r=>{r.precio_preparacion&&r.precio_venta?r.porcentajeGanancia=(r.precio_venta-r.precio_preparacion)/r.precio_preparacion*100:r.porcentajeGanancia=0}),this.filtrarRecetas()}catch(r){console.error("Error cargando recetas:",r)}finally{this.cargando=!1}})}filtrarRecetas(){if(!this.terminoBusquedaReceta){this.recetasFiltradas=[...this.recetas];return}let r=this.terminoBusquedaReceta.toLowerCase();this.recetasFiltradas=this.recetas.filter(e=>e.nombre.toLowerCase().includes(r))}confirmarEliminarReceta(r){this.recetaAEliminar=r,this.mostrarConfirmacionEliminar=!0}eliminarReceta(){return E(this,null,function*(){if(this.recetaAEliminar)try{this.cargando=!0,yield this.cargarRecetas()}catch(r){console.error("Error eliminando receta:",r)}finally{this.cargando=!1,this.mostrarConfirmacionEliminar=!1,this.recetaAEliminar=null}})}seleccionarReceta(r){this.recetaSeleccionada=I({},r)}abrirModalEditarReceta(r){this.receta=k(I({},r),{ingredientes:r.ingredientes.map(e=>I({},e))}),this.mostrarModalEditarReceta=!0,this.calcularPrecioPreparacion(),this.calcularGanancia()}eliminarIngrediente(r){this.receta.ingredientes.splice(r,1),this.calcularPrecioPreparacion()}cerrarModalEditarReceta(){this.mostrarModalEditarReceta=!1,this.limpiarCamposIngredientes()}actualizarReceta(){return E(this,null,function*(){if(!(!this.receta.nombre||this.receta.ingredientes.length===0||!this.receta.id))try{this.cargando=!0,this.calcularPrecioPreparacion(),yield this.supabaseService.actualizarReceta(this.receta.id,this.receta,this.nuevaImagenFile),M.default.fire({icon:"success",title:"\xA1Receta actualizada!",showConfirmButton:!1,timer:1500}),yield this.cargarRecetas(),this.calcularGanancia(),this.limpiarCamposIngredientes(),this.terminoBusquedaReceta="",this.cerrarModalEditarReceta(),this.nuevaImagenFile=void 0}catch(r){console.error("Error actualizando receta:",r)}finally{this.cargando=!1}})}limpiarCamposIngredientes(){this.buscador="",this.ingredienteSeleccionado=null,this.cantidadSeleccionada=1,this.filtrarIngredientes()}calcularGanancia(){this.calcularPrecioPreparacion(),this.receta.precio_venta&&this.receta.precio_venta>0?(this.receta.ganancia=this.receta.precio_venta-this.receta.precio_preparacion,this.receta.porcentajeGanancia=this.receta.ganancia/this.receta.precio_preparacion*100):(this.receta.ganancia=0,this.receta.porcentajeGanancia=0)}static \u0275fac=function(e){return new(e||a)(F(re))};static \u0275cmp=P({type:a,selectors:[["app-recetas"]],decls:20,vars:4,consts:[[1,"container","mx-auto","p-6"],[1,"mb-8","text-center"],[1,"text-3xl","font-bold","text-black","mb-2"],[1,"text-gray-600"],[1,"w-24","h-1","bg-orange-500","mx-auto","mt-4"],[1,"flex","flex-col","md:flex-row","justify-between","gap-4","mb-8"],[1,"w-full","md:w-1/2"],[1,"relative"],["type","text","placeholder","Buscar receta por nombre","id","search-recipe","name","searchRecipe",1,"w-full","p-3","pl-10","border","border-gray-300","rounded-lg","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-orange-500","focus:border-transparent","transition",3,"ngModelChange","input","ngModel"],[1,"fas","fa-search","absolute","left-3","top-1/2","transform","-translate-y-1/2","text-gray-400"],[1,"bg-orange-500","hover:bg-orange-600","text-white","p-3","rounded-lg","shadow-md","transition","duration-300","flex","items-center","justify-center","space-x-2","cursor-pointer",3,"click"],[1,"fas","fa-plus"],["id","recipes-list",1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-6","mt-6"],["class","bg-white p-6 rounded-lg shadow-lg border border-gray-100 hover:shadow-xl transition duration-300 transform hover:-translate-y-1 mb-6",4,"ngFor","ngForOf"],["class","fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm px-2",4,"ngIf"],["class","fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm px-4",4,"ngIf"],[1,"bg-white","p-6","rounded-lg","shadow-lg","border","border-gray-100","hover:shadow-xl","transition","duration-300","transform","hover:-translate-y-1","mb-6"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-xl","font-bold","text-black"],[1,"flex","space-x-2"],["title","Editar",1,"text-orange-500","hover:text-orange-600","cursor-pointer",3,"click"],[1,"fas","fa-edit"],["class","mb-4",4,"ngIf"],[1,"bg-white","rounded-lg","overflow-hidden","border","border-gray-200"],[1,"w-full"],[1,"bg-black","text-white"],[1,"py-2","px-4","text-left"],["class","border-b border-gray-200",3,"ngClass",4,"ngFor","ngForOf"],[1,"bg-yellow-50"],["colspan","2",1,"py-2","px-4","text-right","font-bold","text-black"],[1,"py-2","px-4","font-bold","text-black"],[1,"mt-4","text-sm","text-gray-500","space-y-4"],[1,"flex","justify-between","items-center"],[1,"font-medium","text-gray-700"],[1,"font-semibold","text-gray-800"],[1,"font-semibold","text-green-600"],[1,"font-semibold","text-lg",3,"ngClass"],["class","text-sm text-green-600",4,"ngIf"],["class","text-sm text-red-600",4,"ngIf"],[1,"mb-4"],[1,"w-full","h-48","object-cover","rounded-lg",3,"src","alt"],[1,"border-b","border-gray-200",3,"ngClass"],[1,"py-2","px-4"],[1,"text-sm","text-green-600"],[1,"font-bold"],[1,"text-sm","text-red-600"],[1,"fixed","inset-0","z-50","flex","items-center","justify-center","bg-black/60","backdrop-blur-sm","px-2"],[1,"bg-white","text-black","rounded-xl","w-full","max-w-3xl","shadow-2xl","border","border-yellow-600","relative","max-h-[90vh]","flex","flex-col","overflow-hidden"],["title","Cerrar",1,"absolute","top-3","right-3","text-black","bg-orange-500","hover:bg-orange-600","rounded-full","w-8","h-8","flex","items-center","justify-center","transition","duration-200","cursor-pointer",3,"click"],[1,"bi","bi-x-lg","text-base"],[1,"bg-white","text-black","px-4","py-4","flex","items-center","justify-between","border-b","border-yellow-500"],[1,"text-lg","font-semibold"],[1,"overflow-y-auto",3,"submit"],[1,"px-4","py-3","bg-white","space-y-4"],[1,"space-y-1"],["for","nombre",1,"block","text-gray-700","font-medium"],["type","text","id","nombre","name","nombre","required","","placeholder","Ej: Pizza Margarita",1,"w-full","mt-1","p-2","border","rounded","focus:ring-2","focus:ring-amber-500","focus:border-amber-500",3,"ngModelChange","ngModel"],[1,"block","text-gray-700","font-medium"],[1,"relative","border-2","border-dashed","border-gray-300","rounded-lg","p-4","mt-1","hover:border-amber-400","transition-colors"],["type","file","id","imagenReceta","accept","image/*","title","imagen",1,"absolute","inset-0","w-full","h-full","opacity-0","cursor-pointer",3,"change"],[1,"text-center"],[1,"bi","bi-image","text-3xl","text-gray-400"],[1,"mt-2","text-sm","text-gray-600"],[1,"text-xs","text-gray-500","mt-1"],["class","mt-2 flex justify-center",4,"ngIf"],["for","precioVenta",1,"block","text-gray-700","font-medium"],["type","number","id","precioVenta","name","precioVenta","required","","placeholder","Ej: 15.00",1,"w-full","mt-1","p-2","border","rounded","focus:ring-2","focus:ring-amber-500","focus:border-amber-500",3,"ngModelChange","ngModel"],["for","buscarIngrediente",1,"block","text-gray-700","font-medium"],["type","text","name","buscador","placeholder","Escribe para buscar ingredientes...",1,"w-full","mt-1","p-2","border","rounded","focus:ring-2","focus:ring-amber-500","focus:border-amber-500",3,"ngModelChange","input","ngModel"],["class","absolute right-3 top-3 text-gray-400 hover:text-gray-600 cursor-pointer",3,"click",4,"ngIf"],["class","max-h-60 overflow-y-auto mt-2 p-2 border rounded bg-gray-50 space-y-2",4,"ngIf"],["class","text-center text-gray-500 py-4",4,"ngIf"],["class","mt-4 p-3 bg-amber-50 rounded-lg border border-amber-200",4,"ngIf"],[1,"mt-4"],[1,"text-gray-700","font-medium"],[1,"text-sm","font-medium"],["class","bg-gray-100 p-2 mt-2 border rounded",4,"ngIf"],["class","text-center text-gray-500 py-4 border border-dashed rounded mt-2",4,"ngIf"],[1,"flex","justify-between","items-center","mt-2"],[1,"text-sm","font-medium","text-green-600"],[1,"mt-6","flex","justify-between","border-t","pt-4"],["type","button",1,"px-5","py-2","bg-gray-300","text-black","rounded-lg","hover:bg-gray-400","transition","cursor-pointer",3,"click"],["type","submit",1,"px-5","py-2","bg-amber-600","text-white","rounded-lg","hover:bg-amber-500","transition","disabled:bg-amber-300","disabled:cursor-not-allowed","cursor-pointer",3,"disabled"],[1,"mt-2","flex","justify-center"],["alt","Vista previa de la receta",1,"max-h-40","rounded-lg","border","border-gray-200","object-cover",3,"src"],["type","button","class","absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-600","title","ver",3,"click",4,"ngIf"],["type","button","title","ver",1,"absolute","-top-2","-right-2","bg-red-500","text-white","rounded-full","w-6","h-6","flex","items-center","justify-center","hover:bg-red-600",3,"click"],[1,"bi","bi-x","text-sm"],[1,"absolute","right-3","top-3","text-gray-400","hover:text-gray-600","cursor-pointer",3,"click"],[1,"bi","bi-x-lg"],[1,"max-h-60","overflow-y-auto","mt-2","p-2","border","rounded","bg-gray-50","space-y-2"],["class","flex items-center justify-between p-2 hover:bg-gray-100 rounded",4,"ngFor","ngForOf"],[1,"flex","items-center","justify-between","p-2","hover:bg-gray-100","rounded"],[1,"flex","items-center","space-x-3"],[1,"text-sm","text-gray-500"],["type","button",1,"px-3","py-1","bg-blue-500","text-white","rounded","hover:bg-blue-600","transition","duration-200","disabled:bg-gray-300","disabled:cursor-not-allowed","cursor-pointer",3,"click","disabled"],[1,"text-center","text-gray-500","py-4"],[1,"mt-4","p-3","bg-amber-50","rounded-lg","border","border-amber-200"],[1,"flex","items-center","justify-between","mb-2"],[1,"font-medium"],["type","button","title","cerrar",1,"text-gray-500","hover:text-gray-700","cursor-pointer",3,"click"],[1,"flex","items-center","space-x-4"],[1,"flex-1"],[1,"block","text-gray-700","text-sm","mb-1"],["type","number","name","cantidadSeleccionada","min","1","placeholder","Cantidad","required","",1,"w-full","p-2","border","rounded",3,"ngModelChange","ngModel","max"],["type","button",1,"mt-5","px-4","py-2","bg-green-500","text-white","rounded","hover:bg-green-600","transition","duration-200","cursor-pointer",3,"click"],["class","text-xs text-gray-500 mt-1",4,"ngIf"],["class","text-xs text-red-500 mt-1",4,"ngIf"],[1,"text-xs","text-red-500","mt-1"],[1,"bg-gray-100","p-2","mt-2","border","rounded"],[1,"divide-y","divide-gray-200"],["class","py-2 flex justify-between items-center",4,"ngFor","ngForOf"],[1,"py-2","flex","justify-between","items-center"],[1,"text-sm","text-gray-500","ml-2"],[1,"flex","items-center","space-x-2"],["type","button","title","Eliminar",1,"text-red-500","hover:text-red-700",3,"click"],[1,"bi","bi-trash"],[1,"text-center","text-gray-500","py-4","border","border-dashed","rounded","mt-2"],[1,"fixed","inset-0","z-50","flex","items-center","justify-center","bg-black/60","backdrop-blur-sm","px-4"],[1,"bg-white","text-black","rounded-xl","w-full","max-w-4xl","shadow-2xl","border","border-yellow-600","relative","max-h-[90vh]","flex","flex-col","overflow-hidden"],[3,"submit"],[1,"px-4","py-3","bg-white","overflow-y-auto","flex-1","max-h-[75vh]"],["for","nombre",1,"block","text-gray-700","font-semibold"],["type","text","id","nombre","name","nombre","required","","placeholder","Nombre de la receta",1,"w-full","mt-1","p-2","border","rounded-lg",3,"ngModelChange","ngModel"],[1,"block","text-gray-700","font-semibold","mb-1"],[1,"relative","border-2","border-dashed","border-gray-300","rounded-lg","p-4","hover:border-amber-400","transition-colors"],["type","file","id","imagenEditarReceta","accept","image/jpeg, image/png","title","imagen",1,"absolute","inset-0","w-full","h-full","opacity-0","cursor-pointer",3,"change"],[1,"mt-6","bg-gray-50","p-4","rounded-lg","border","border-gray-300"],[1,"text-gray-700","font-semibold","mb-3"],["type","text","placeholder","Buscar ingrediente...","name","buscarIngrediente",1,"w-full","p-3","border","rounded-lg",3,"ngModelChange","input","ngModel"],[1,"max-h-60","overflow-y-auto","mb-4","border","rounded-lg"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-50","sticky","top-0"],[1,"px-4","py-2","text-left","text-xs","font-medium","text-gray-500","uppercase"],[1,"bg-white","divide-y","divide-gray-200"],[4,"ngIf"],["class","hover:bg-gray-50 cursor-pointer",3,"bg-blue-50",4,"ngFor","ngForOf"],[1,"flex","flex-col","sm:flex-row","gap-3","items-end","mb-4"],["for","cantidadIngrediente",1,"block","text-sm","text-gray-600","mb-1"],["type","number","id","cantidadIngrediente","name","cantidadIngrediente","min","1","placeholder","Cantidad",1,"w-full","p-2","border","rounded-lg",3,"ngModelChange","ngModel"],["type","button",1,"px-5","py-2","bg-green-500","text-white","rounded-lg","hover:bg-green-600","transition",3,"click"],[1,"mt-6"],[1,"text-gray-700","font-semibold"],["class","bg-gray-100 p-4 mt-2 border rounded-lg",4,"ngIf"],["class","text-gray-500 mt-2",4,"ngIf"],["for","precio_preparacion",1,"block","text-gray-700"],["type","number","readonly","","title","Precio preparaci\xF3n",1,"w-full","mt-1","p-2","border","rounded-lg","bg-gray-100",3,"value"],["for","precio_venta",1,"block","text-gray-700","mt-4"],["type","number","name","precio_venta","title","Precio de venta",1,"w-full","mt-1","p-2","border","rounded-lg",3,"ngModelChange","ngModel"],["for","ganancia",1,"block","text-gray-700","mt-4"],["type","number","readonly","","title","Ganancia",1,"w-full","mt-1","p-2","border","rounded-lg","bg-gray-100",3,"value"],[1,"mt-6","flex","justify-between","gap-4"],["type","button",1,"px-6","py-3","bg-gray-300","text-black","rounded-lg","hover:bg-gray-400","transition","cursor-pointer",3,"click"],["type","submit",1,"px-6","py-3","bg-amber-600","text-white","rounded-lg","hover:bg-amber-500","transition","cursor-pointer"],["title","imagen",1,"max-h-40","rounded-lg","border","border-gray-200","object-cover",3,"src"],["type","button","title","imagen",1,"absolute","-top-2","-right-2","bg-red-500","text-white","rounded-full","w-6","h-6","flex","items-center","justify-center","hover:bg-red-600",3,"click"],["colspan","3",1,"px-4","py-2","text-center","text-sm","text-gray-500"],[1,"hover:bg-gray-50","cursor-pointer"],[1,"px-4","py-2","whitespace-nowrap"],["type","radio","name","ingredienteSeleccionado","title","s",1,"h-4","w-4","text-blue-600","focus:ring-blue-500","border-gray-300",3,"ngModelChange","value","ngModel","ngModelOptions"],[1,"px-4","py-2","whitespace-nowrap","text-sm","text-gray-900"],[1,"bg-gray-100","p-4","mt-2","border","rounded-lg"],["class","flex justify-between items-center py-2",4,"ngFor","ngForOf"],[1,"flex","justify-between","items-center","py-2"],[1,"flex","items-center","space-x-2","w-full"],["type","number","min","1","title","Cantidad del ingrediente",1,"w-20","p-1","border","rounded-lg","text-center",3,"ngModelChange","ngModel","name"],[1,"flex-1","text-right"],["type","button","title","Eliminar ingrediente",1,"text-red-500","hover:text-red-600","cursor-pointer",3,"click"],[1,"text-gray-500","mt-2"]],template:function(e,l){e&1&&(i(0,"div",0)(1,"div",1)(2,"h2",2),o(3,"Gesti\xF3n de Recetas"),t(),i(4,"p",3),o(5,"Administra tus recetas, ingredientes y costos"),t(),x(6,"div",4),t(),i(7,"div",5)(8,"div",6)(9,"div",7)(10,"input",8),S("ngModelChange",function(s){return C(l.terminoBusquedaReceta,s)||(l.terminoBusquedaReceta=s),s}),g("input",function(){return l.filtrarRecetas()}),t(),x(11,"i",9),t()(),i(12,"button",10),g("click",function(){return l.abrirModalReceta()}),x(13,"i",11),i(14,"span"),o(15,"Agregar Receta"),t()()(),i(16,"div",12),_(17,ge,47,21,"div",13),t()(),_(18,ke,65,23,"div",14)(19,We,70,12,"div",15)),e&2&&(c(10),w("ngModel",l.terminoBusquedaReceta),c(7),m("ngForOf",l.recetasFiltradas),c(),m("ngIf",l.mostrarModalReceta),c(),m("ngIf",l.mostrarModalEditarReceta))},dependencies:[D,z,A,L,q,U,ne,Y,H,Z,$,J,K,ie,te,ee,X,Q],styles:[".eliminar-ingrediente[_ngcontent-%COMP%]{color:red;background:none;border:none;cursor:pointer;font-size:18px;transition:color .2s ease-in-out}.eliminar-ingrediente[_ngcontent-%COMP%]:hover{color:#ff4747}"]})};export{T as default};
