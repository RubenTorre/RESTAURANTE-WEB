import{c as U,d as F,e as D,f as H,h as $}from"./chunk-EWPQKLG2.js";import{a as A}from"./chunk-BJ3VZH2X.js";import{a as W}from"./chunk-IY34DK4E.js";import{Ba as B,Bc as N,Ca as a,Ga as V,Ha as g,Ma as x,Qa as p,Xa as d,Za as v,_a as P,aa as b,ba as f,db as r,eb as s,fb as u,hc as z,ic as j,jb as _,kb as m,lb as c,rb as R,sb as E,tb as T,uc as L,vb as h,wb as M}from"./chunk-YGAPY4LI.js";import"./chunk-LMZWYZYD.js";import{a as S,b as I,h as q,j as O}from"./chunk-K4ALXBGI.js";var y=q(W());var K=["sidebarContainer"];function X(t,n){if(t&1){let e=_();r(0,"button",7),m("click",function(){b(e);let o=c();return f(o.toggleMobileMenu())}),u(1,"i",8),s()}}function Y(t,n){if(t&1){let e=_();r(0,"div",9),m("click",function(){b(e);let o=c();return f(o.closeMenuOnMobile())}),s()}}function Z(t,n){if(t&1&&(r(0,"div",10),u(1,"img",11),r(2,"div",12),h(3),s()()),t&2){let e=c();a(3),M(e.nombreUsuario)}}function ee(t,n){if(t&1&&u(0,"i",17),t&2){let e=c().$implicit;v("bi-chevron-down",!e.expanded)("bi-chevron-up",e.expanded)}}function ne(t,n){if(t&1){let e=_();r(0,"a",20),m("click",function(){let o=b(e).$implicit,l=c(2).$implicit,C=c();return f(C.handleSubmenuItemClick(o,l))}),u(1,"i"),r(2,"span",21),h(3),s()()}if(t&2){let e=n.$implicit;v("cursor-pointer",e.action),d("routerLink",e.route)("routerLinkActive",e.action?"":"bg-gray-700"),a(),P(e.icon+" submenu-icon"),a(2),M(e.label)}}function ie(t,n){if(t&1&&(r(0,"div",18),p(1,ne,4,7,"a",19),s()),t&2){let e=c().$implicit;a(),d("ngForOf",e.submenus)}}function te(t,n){if(t&1){let e=_();r(0,"li")(1,"div",13),m("click",function(){let o=b(e).$implicit,l=c();return f(!l.isMobileView&&l.toggleSubmenu(o))}),u(2,"i"),r(3,"span",14),h(4),s(),p(5,ee,1,4,"i",15),s(),p(6,ie,2,1,"div",16),s()}if(t&2){let e=n.$implicit,i=c();a(2),P(e.icon+" menu-icon"),a(2),M(e.label),a(),d("ngIf",e.submenus),a(),d("ngIf",e.submenus&&(i.isMobileView||e.expanded))}}var w=class t{constructor(n,e,i,o){this.userService=n;this.renderer=e;this.SupabaseService=i;this.router=o;this.checkViewport(),this.renderer.listen("window","resize",()=>this.checkViewport())}isHovered=!1;nombreUsuario="";rolUsuario="";visibleMenuItems=[];isMobileView=!1;forceCollapsed=!1;sidebarContainer;ngOnInit(){this.userService.nombreUsuario$.subscribe(n=>{this.nombreUsuario=n}),this.userService.rolUsuario$.subscribe(n=>{this.rolUsuario=n,this.filtrarMenuPorRol(n)})}onClickOutside(n){if(this.isMobileView&&!this.forceCollapsed){let e=this.sidebarContainer.nativeElement.contains(n.target),i=n.target.closest(".mobile-menu-btn");!e&&!i&&this.closeMenuOnMobile()}}checkViewport(){this.isMobileView=window.innerWidth<768,this.isMobileView?this.forceCollapsed=!0:this.forceCollapsed=!1}toggleMobileMenu(){this.isMobileView&&(this.forceCollapsed=!this.forceCollapsed,this.isHovered=!this.forceCollapsed)}closeMenuOnMobile(){this.isMobileView&&(this.forceCollapsed=!0,this.isHovered=!1)}filtrarMenuPorRol(n){let i={administrador:{Dashboard:[],Usuarios:[],Men\u00FA:[],Facturaci\u00F3n:[],Cuenta:[],Reservaciones:[]},gerente:{Dashboard:[],Usuarios:[],Men\u00FA:[],Facturaci\u00F3n:[],Cuenta:[],Reservaciones:[]},mesero:{Men\u00FA:["Tomar Pedido"],Cuenta:[]},cocinero:{Dashboard:[],Men\u00FA:["Recetas","Productos"],Cuenta:[]},cajero:{Dashboard:["Resumen"],Facturaci\u00F3n:[],Cuenta:[],Reservaciones:[]}}[n]||{};this.visibleMenuItems=this.menuItems.map(o=>{if(i.hasOwnProperty(o.label)){let l=i[o.label];if(o.submenus&&o.submenus.length>0){let C=l.length>0?o.submenus.filter(Q=>l.includes(Q.label)):o.submenus;return C.length>0?I(S({},o),{submenus:C}):null}return o}return null}).filter(Boolean)}menuItems=[{icon:"bi bi-speedometer2",label:"Dashboard",submenus:[{label:"Resumen",route:"/dashboard",icon:"bi bi-house-door"},{label:"Reportes",route:"/reportes",icon:"bi bi-file-earmark"}],expanded:!1},{icon:"bi bi-people",label:"Usuarios",route:"/Usuarios",submenus:[{label:"Lista",route:"/Usuarios",icon:"bi bi-list-ul"}],expanded:!1},{icon:"bi bi-card-list",label:"Men\xFA",route:"/menu",submenus:[{label:"Tomar Pedido",route:"/menu/carta",icon:"bi bi-book"},{label:"Reservaciones",route:"/menu/reservaciones",icon:"bi bi-calendar-check"},{label:"Productos",route:"/menu/productos",icon:"bi bi-cup-straw"},{label:"Recetas",route:"/menu/recetas",icon:"bi bi-egg"}],expanded:!1},{icon:"bi bi-receipt",label:"Facturaci\xF3n",submenus:[{label:"Cobros",route:"/facturas/cobros",icon:"bi bi-cash-stack"},{label:"Pedidos",route:"/facturas/imprimir",icon:"bi bi-receipt-cutoff"},{label:"Egresos",route:"/egresos",icon:"bi bi-receipt-cutoff"},{label:"Contratos",route:"/Contratos",icon:"bi bi-receipt-cutoff"},{label:"Cierre Caja",route:"/Cierre/Caja",icon:"bi bi-receipt-cutoff"}],expanded:!1},{icon:"bi bi-person-circle",label:"Cuenta",submenus:[{label:"Mi perfil",route:"/perfil",icon:"bi bi-person"},{label:"Cerrar sesi\xF3n",icon:"bi bi-box-arrow-right",action:"logout"}],expanded:!1}];toggleSubmenu(n){n.expanded?n.expanded=!1:(this.visibleMenuItems.forEach(e=>e.expanded=!1),n.expanded=!0)}handleSubmenuItemClick(n,e){n.action?this.handleSubmenuClick(n):this.isMobileView?this.closeMenuOnMobile():e.expanded=!1}handleSubmenuClick(n){return O(this,null,function*(){n.action==="logout"&&(yield this.cerrarSesion())})}cerrarSesion(){return O(this,null,function*(){if((yield y.default.fire({title:"\xBFEst\xE1s seguro?",text:"Est\xE1s a punto de cerrar sesi\xF3n.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"S\xED, cerrar sesi\xF3n",cancelButtonText:"Cancelar"})).isConfirmed)try{yield this.SupabaseService.logout(),this.userService.limpiarNombre(),this.userService.limpiarRol(),this.router.navigate(["/login"])}catch(e){console.error("Error al cerrar sesi\xF3n:",e),y.default.fire("Error","No se pudo cerrar sesi\xF3n.","error")}})}static \u0275fac=function(e){return new(e||t)(g(A),g(V),g(N),g(F))};static \u0275cmp=x({type:t,selectors:[["app-side-bar"]],viewQuery:function(e,i){if(e&1&&R(K,5),e&2){let o;E(o=T())&&(i.sidebarContainer=o.first)}},hostBindings:function(e,i){e&1&&m("click",function(l){return i.onClickOutside(l)},!1,B)},decls:7,vars:8,consts:[["sidebarContainer",""],["class","mobile-menu-btn",3,"click",4,"ngIf"],["class","sidebar-backdrop",3,"click",4,"ngIf"],[1,"sidebar-container"],["class","header-section",4,"ngIf"],[1,"menu-list"],[4,"ngFor","ngForOf"],[1,"mobile-menu-btn",3,"click"],["title","menu",1,"bi","bi-list"],[1,"sidebar-backdrop",3,"click"],[1,"header-section"],["src","assets/splash/logo.jpg","alt","Logo",1,"logo"],[1,"username"],[1,"menu-item",3,"click"],[1,"menu-label"],["class","bi chevron-icon",3,"bi-chevron-down","bi-chevron-up",4,"ngIf"],["class","submenu-container",4,"ngIf"],[1,"bi","chevron-icon"],[1,"submenu-container"],["class","submenu-item",3,"routerLink","routerLinkActive","cursor-pointer","click",4,"ngFor","ngForOf"],[1,"submenu-item",3,"click","routerLink","routerLinkActive"],[1,"submenu-label"]],template:function(e,i){e&1&&(p(0,X,2,0,"button",1)(1,Y,1,0,"div",2),r(2,"div",3,0),p(4,Z,4,1,"div",4),r(5,"ul",5),p(6,te,7,5,"li",6),s()()),e&2&&(d("ngIf",i.isMobileView&&i.forceCollapsed),a(),d("ngIf",i.isMobileView&&!i.forceCollapsed),a(),v("expanded",!i.forceCollapsed)("mobile-view",i.isMobileView),a(2),d("ngIf",!i.forceCollapsed),a(2),d("ngForOf",i.visibleMenuItems))},dependencies:[L,z,j,D,$,H],styles:[".sidebar-container[_ngcontent-%COMP%]{width:64px;height:100vh;background-color:#000;color:#fff;transition:width .3s ease;overflow-y:hidden;display:flex;flex-direction:column}.sidebar-container.expanded[_ngcontent-%COMP%]{width:256px;overflow-y:auto}.header-section[_ngcontent-%COMP%]{text-align:center;padding:16px}.restaurant-name[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:700;color:#fbbf24}.logo[_ngcontent-%COMP%]{width:100%;height:100px;border:2px solid #f59e0b;object-fit:cover;margin:0 auto;border-radius:20px}.username[_ngcontent-%COMP%]{font-size:.875rem;color:#d1d5db;margin-top:10px}.menu-item[_ngcontent-%COMP%]{display:flex;align-items:center;padding:12px 0;cursor:pointer;justify-content:center}.sidebar-container.expanded[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]{justify-content:flex-start;padding:12px 16px}.menu-item[_ngcontent-%COMP%]:hover{background-color:#333}.menu-icon[_ngcontent-%COMP%]{font-size:1.25rem;min-width:24px;text-align:center}.menu-label[_ngcontent-%COMP%]{margin-left:12px;white-space:nowrap;display:none}.sidebar-container.expanded[_ngcontent-%COMP%]   .menu-label[_ngcontent-%COMP%]{display:inline}.submenu-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center}.sidebar-container.expanded[_ngcontent-%COMP%]   .submenu-container[_ngcontent-%COMP%]{align-items:stretch;padding-left:24px}.submenu-item[_ngcontent-%COMP%]{padding:10px 0;cursor:pointer;display:flex;justify-content:center}.sidebar-container.expanded[_ngcontent-%COMP%]   .submenu-item[_ngcontent-%COMP%]{justify-content:flex-start;padding:8px 16px}.submenu-item[_ngcontent-%COMP%]:hover{background-color:#333}.submenu-icon[_ngcontent-%COMP%]{font-size:1.1rem}.submenu-label[_ngcontent-%COMP%]{display:none;margin-left:8px}.sidebar-container.expanded[_ngcontent-%COMP%]   .submenu-label[_ngcontent-%COMP%]{display:inline}.menu-list[_ngcontent-%COMP%]{flex-grow:1;overflow-y:auto;padding-bottom:16px}.menu-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.menu-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#888;border-radius:10px;transition:background .3s ease}.menu-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#555}.menu-list[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#333;border-radius:10px}.sidebar-container[_ngcontent-%COMP%]:not(.expanded)   .menu-list[_ngcontent-%COMP%]{overflow-y:hidden}.mobile-menu-btn[_ngcontent-%COMP%]{position:fixed;top:10px;left:10px;z-index:1001;background:#2d3748;color:#fff;border:none;padding:8px;border-radius:4px;font-size:1.2rem;cursor:pointer}.sidebar-container.mobile-view[_ngcontent-%COMP%]{position:fixed;z-index:1000;height:100vh;transition:transform .3s ease}.sidebar-container.mobile-view[_ngcontent-%COMP%]:not(.expanded)   .menu-label[_ngcontent-%COMP%], .sidebar-container.mobile-view[_ngcontent-%COMP%]:not(.expanded)   .header-section[_ngcontent-%COMP%], .sidebar-container.mobile-view[_ngcontent-%COMP%]:not(.expanded)   .chevron-icon[_ngcontent-%COMP%]{display:none}.sidebar-container.mobile-view[_ngcontent-%COMP%]:not(.expanded)   .menu-item[_ngcontent-%COMP%]{justify-content:center}@media (min-width: 768px){.mobile-menu-btn[_ngcontent-%COMP%]{display:none}.sidebar-container.mobile-view[_ngcontent-%COMP%]{position:relative;transform:none!important}}.mobile-menu-btn[_ngcontent-%COMP%]{position:fixed;top:10px;left:10px;z-index:1001;background:#2d3748;color:#fff;border:none;padding:8px;border-radius:4px;font-size:1.2rem;cursor:pointer;transition:opacity .3s ease}.sidebar-container.mobile-view.expanded[_ngcontent-%COMP%] ~ .mobile-menu-btn[_ngcontent-%COMP%]{opacity:0;pointer-events:none}.sidebar-container.mobile-view.expanded[_ngcontent-%COMP%] ~ .mobile-menu-btn[_ngcontent-%COMP%]{transform:translate(calc(80% - 15px));opacity:0;pointer-events:none}.sidebar-backdrop[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;z-index:999;opacity:0;pointer-events:none;transition:opacity .3s ease}.sidebar-container.mobile-view.expanded[_ngcontent-%COMP%] ~ .sidebar-backdrop[_ngcontent-%COMP%]{opacity:1;pointer-events:auto}.sidebar-container.mobile-view[_ngcontent-%COMP%]{z-index:1000}.mobile-menu-btn[_ngcontent-%COMP%]{position:fixed;top:15px;left:15px;z-index:1001;background:#2d3748e6;color:#fff;border:none;padding:10px;border-radius:50%;width:40px;height:40px;display:flex;align-items:center;justify-content:center;font-size:1.2rem;cursor:pointer;box-shadow:0 2px 5px #0003;transition:all .3s ease}.mobile-menu-btn[_ngcontent-%COMP%]:hover{background:#2d3748;transform:scale(1.05)}.sidebar-backdrop[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;z-index:999;opacity:1;transition:opacity .3s ease}.sidebar-container.mobile-view[_ngcontent-%COMP%]{position:fixed;z-index:1000;height:100vh;transition:transform .3s ease;left:0;top:0}.sidebar-container.mobile-view[_ngcontent-%COMP%]:not(.expanded){transform:translate(-100%)}.sidebar-container.mobile-view.expanded[_ngcontent-%COMP%]{transform:translate(0);box-shadow:2px 0 10px #0003}@media (min-width: 768px){.mobile-menu-btn[_ngcontent-%COMP%], .sidebar-backdrop[_ngcontent-%COMP%]{display:none}.sidebar-container.mobile-view[_ngcontent-%COMP%]{position:relative;transform:none!important;box-shadow:none;height:auto}}"]})};var k=class t{static \u0275fac=function(e){return new(e||t)};static \u0275cmp=x({type:t,selectors:[["app-layout"]],decls:5,vars:0,consts:[[1,"h-screen","grid","grid-cols-[auto_1fr]","bg-gray-50/50"],[1,"flex","flex-col","h-screen","overflow-hidden"],[1,"flex-1","overflow-y-auto","p-4"]],template:function(e,i){e&1&&(r(0,"div",0),u(1,"app-side-bar"),r(2,"div",1)(3,"div",2),u(4,"router-outlet"),s()()())},dependencies:[U,w],encapsulation:2})};export{k as default};
