import{c as H,d as J,e as K,f as Q,g as X,h as Y,i as Z,j as $,n as ee,o as te,p as ie,r as ne}from"./chunk-V4S5BHXF.js";import{a as oe}from"./chunk-IY34DK4E.js";import{Ab as C,Bb as S,Bc as re,Ca as c,Db as G,Eb as N,Fb as O,Ha as F,Kb as b,Lb as h,Ma as P,Mb as M,Qa as _,Xa as m,Za as B,aa as p,ba as u,db as i,eb as t,fb as x,gc as z,hc as A,ic as L,jb as y,kb as g,lb as d,pb as j,sc as q,tc as U,uc as D,vb as a,wb as f,xb as v,ya as R,yb as W,zb as w}from"./chunk-YGAPY4LI.js";import"./chunk-LMZWYZYD.js";import{a as I,b as V,h as ae,j as E}from"./chunk-K4ALXBGI.js";var k=ae(oe());var ce=(o,n)=>({"text-green-600":o,"text-red-600":n}),le=o=>({"bg-gray-50":o}),de=()=>({standalone:!0});function se(o,n){if(o&1&&(i(0,"div",39),x(1,"img",40),t()),o&2){let e=d().$implicit;c(),j("alt","Imagen de ",e.nombre,""),m("src",e.imagen_url,R)}}function me(o,n){if(o&1&&(i(0,"tr",41)(1,"td",42),a(2),t(),i(3,"td",42),a(4),t(),i(5,"td",42),a(6),b(7,"currency"),t()()),o&2){let e=n.$implicit,l=n.even;m("ngClass",N(6,le,l)),c(2),f(e.nombre),c(2),f(e.cantidad),c(2),f(h(7,4,e.precio_unitario))}}function pe(o,n){if(o&1&&(i(0,"div",43),a(1," Ganancia de "),i(2,"span",44),a(3),b(4,"number"),t(),a(5," sobre el costo "),t()),o&2){let e=d().$implicit;c(3),v("",M(4,1,e.porcentajeGanancia,"1.0-0"),"%")}}function ue(o,n){if(o&1&&(i(0,"div",45),a(1," P\xE9rdida de "),i(2,"span",44),a(3),b(4,"number"),t(),a(5," sobre el costo "),t()),o&2){let e=d().$implicit;c(3),v("",M(4,1,e.porcentajeGanancia,"1.0-0"),"%")}}function ge(o,n){if(o&1){let e=y();i(0,"div",16)(1,"div",17)(2,"h3",18),a(3),t(),i(4,"div",19)(5,"button",20),g("click",function(){let r=p(e).$implicit,s=d();return u(s.abrirModalEditarReceta(r))}),x(6,"i",21),t()()(),_(7,se,2,3,"div",22),i(8,"div",23)(9,"div")(10,"table",24)(11,"thead",25)(12,"tr")(13,"th",26),a(14,"Ingrediente"),t(),i(15,"th",26),a(16,"Cant."),t(),i(17,"th",26),a(18,"Precio"),t()()(),i(19,"tbody"),_(20,me,8,8,"tr",27),i(21,"tr",28)(22,"td",29),a(23,"Total Costo"),t(),i(24,"td",30),a(25),b(26,"currency"),t()()()()()(),i(27,"div",31)(28,"div",32)(29,"span",33),a(30,"Costo de Preparaci\xF3n:"),t(),i(31,"span",34),a(32),b(33,"currency"),t()(),i(34,"div",32)(35,"span",33),a(36,"Precio de Venta:"),t(),i(37,"span",35),a(38),b(39,"currency"),t()(),i(40,"div",32)(41,"span",33),a(42,"Ganancia:"),t(),i(43,"span",36),a(44),b(45,"currency"),t()(),_(46,pe,6,4,"div",37)(47,ue,6,4,"div",38),t()()}if(o&2){let e=n.$implicit;c(3),f(e.nombre),c(4),m("ngIf",e.imagen_url),c(13),m("ngForOf",e.ingredientes),c(5),f(h(26,10,e.precio_preparacion)),c(7),f(h(33,12,e.precio_preparacion)),c(6),f(h(39,14,e.precio_venta)),c(5),m("ngClass",O(18,ce,e.ganancia>0,e.ganancia<0)),c(),v(" ",h(45,16,e.ganancia)," "),c(2),m("ngIf",e.ganancia>0),c(),m("ngIf",e.ganancia<0)}}function _e(o,n){if(o&1){let e=y();i(0,"button",87),g("click",function(){p(e);let r=d(3);return u(r.eliminarImagen())}),x(1,"i",88),t()}}function xe(o,n){if(o&1&&(i(0,"div",84)(1,"div",7),x(2,"img",85),_(3,_e,2,0,"button",86),t()()),o&2){let e=d(2);c(2),m("src",e.previewImagenUrl||e.receta.imagen_url,R),c(),m("ngIf",e.previewImagenUrl||e.receta.imagen_url)}}function be(o,n){if(o&1){let e=y();i(0,"span",89),g("click",function(){p(e);let r=d(2);return r.buscador="",u(r.filtrarIngredientes())}),x(1,"i",90),t()}}function fe(o,n){if(o&1&&(i(0,"span",43),a(1),t()),o&2){let e=d().$implicit;c(),v(" Stock: ",e.stock_actual," ")}}function ve(o,n){o&1&&(i(0,"span",45),a(1," Sin stock "),t())}function he(o,n){if(o&1){let e=y();i(0,"div",93)(1,"div",94)(2,"span",74),a(3),t(),i(4,"span",95),a(5),b(6,"currency"),t(),_(7,fe,2,1,"span",37)(8,ve,2,0,"span",38),t(),i(9,"button",96),g("click",function(){let r=p(e).$implicit,s=d(3);return u(s.mostrarInputCantidad(r))}),a(10," Agregar "),t()()}if(o&2){let e=n.$implicit;c(3),f(e.nombre),c(2),v("(",h(6,5,e.costo_unitario),")"),c(2),m("ngIf",e.stock_actual>0),c(),m("ngIf",e.stock_actual<=0),c(),m("disabled",e.stock_actual<=0)}}function ye(o,n){if(o&1&&(i(0,"div",91),_(1,he,11,7,"div",92),t()),o&2){let e=d(2);c(),m("ngForOf",e.productosFiltrados)}}function we(o,n){o&1&&(i(0,"div",97),a(1," No se encontraron ingredientes "),t())}function Ce(o,n){if(o&1&&(i(0,"p",63),a(1),t()),o&2){let e=d(3);c(),v(" Stock disponible: ",e.ingredienteSeleccionado.stock_actual," ")}}function Se(o,n){o&1&&(i(0,"p",109),a(1," Este producto no tiene stock disponible "),t())}function Ee(o,n){if(o&1){let e=y();i(0,"div",98)(1,"div",99)(2,"span",100),a(3),t(),i(4,"button",101),g("click",function(){p(e);let r=d(2);return u(r.ingredienteSeleccionado=null)}),x(5,"i",90),t()(),i(6,"div",102)(7,"div",103)(8,"label",104),a(9,"Cantidad *"),t(),i(10,"input",105),S("ngModelChange",function(r){p(e);let s=d(2);return C(s.cantidadSeleccionada,r)||(s.cantidadSeleccionada=r),u(r)}),t()(),i(11,"button",106),g("click",function(){p(e);let r=d(2);return u(r.agregarIngrediente())}),a(12," Confirmar "),t()(),_(13,Ce,2,1,"p",107)(14,Se,2,0,"p",108),t()}if(o&2){let e=d(2);c(3),v("Agregando: ",e.ingredienteSeleccionado.nombre,""),c(7),w("ngModel",e.cantidadSeleccionada),m("max",e.ingredienteSeleccionado.stock_actual),c(3),m("ngIf",e.ingredienteSeleccionado.stock_actual>0),c(),m("ngIf",e.ingredienteSeleccionado.stock_actual<=0)}}function Ie(o,n){if(o&1){let e=y();i(0,"li",113)(1,"div")(2,"span",100),a(3),t(),i(4,"span",114),a(5),b(6,"currency"),t()(),i(7,"div",115)(8,"span",100),a(9),b(10,"currency"),t(),i(11,"button",116),g("click",function(){let r=p(e).index,s=d(3);return u(s.eliminarIngrediente(r))}),x(12,"i",117),t()()()}if(o&2){let e=n.$implicit;c(3),f(e.nombre),c(2),W("(",e.cantidad," x ",h(6,4,e.precio_unitario),")"),c(4),f(h(10,6,e.cantidad*e.precio_unitario))}}function Re(o,n){if(o&1&&(i(0,"div",110)(1,"ul",111),_(2,Ie,13,8,"li",112),t()()),o&2){let e=d(2);c(2),m("ngForOf",e.receta.ingredientes)}}function Me(o,n){o&1&&(i(0,"div",118),a(1," No hay ingredientes seleccionados "),t())}function ke(o,n){if(o&1){let e=y();i(0,"div",46)(1,"div",47)(2,"button",48),g("click",function(){p(e);let r=d();return u(r.cerrarModalReceta())}),x(3,"i",49),t(),i(4,"div",50)(5,"h2",51),a(6),t()(),i(7,"form",52),g("submit",function(){p(e);let r=d();return u(r.guardarReceta())}),i(8,"div",53)(9,"div",54)(10,"label",55),a(11,"Nombre de la receta *"),t(),i(12,"input",56),S("ngModelChange",function(r){p(e);let s=d();return C(s.receta.nombre,r)||(s.receta.nombre=r),u(r)}),t()(),i(13,"div",54)(14,"label",57),a(15,"Imagen de la receta"),t(),i(16,"div",58)(17,"input",59),g("change",function(r){p(e);let s=d();return u(s.onImagenChange(r))}),t(),i(18,"div",60),x(19,"i",61),i(20,"p",62),a(21),t(),i(22,"p",63),a(23,"Formatos: JPG, PNG (Max. 2MB)"),t()()(),_(24,xe,4,2,"div",64),t(),i(25,"div",54)(26,"label",65),a(27,"Precio de Venta *"),t(),i(28,"input",66),S("ngModelChange",function(r){p(e);let s=d();return C(s.receta.precio_venta,r)||(s.receta.precio_venta=r),u(r)}),g("ngModelChange",function(){p(e);let r=d();return u(r.calcularGanancia())}),t()(),i(29,"div",54)(30,"label",67),a(31,"Buscar Ingredientes *"),t(),i(32,"div",7)(33,"input",68),S("ngModelChange",function(r){p(e);let s=d();return C(s.buscador,r)||(s.buscador=r),u(r)}),g("input",function(){p(e);let r=d();return u(r.filtrarIngredientes())}),t(),_(34,be,2,0,"span",69),t()(),_(35,ye,2,1,"div",70)(36,we,2,0,"div",71)(37,Ee,15,5,"div",72),i(38,"div",73)(39,"div",32)(40,"h3",74),a(41,"Ingredientes Seleccionados:"),t(),i(42,"span",75),a(43),b(44,"currency"),t()(),_(45,Re,3,1,"div",76)(46,Me,2,0,"div",77),t(),i(47,"div",78)(48,"div",32)(49,"span",33),a(50,"Precio de Preparaci\xF3n:"),t(),i(51,"span",75),a(52),b(53,"currency"),t()(),i(54,"div",32)(55,"span",33),a(56,"Precio de Venta:"),t(),i(57,"span",75),a(58),b(59,"currency"),t()(),i(60,"div",32)(61,"span",33),a(62,"Ganancia:"),t(),i(63,"span",79),a(64),b(65,"currency"),t()(),i(66,"div",32)(67,"span",33),a(68,"Porcentaje de Ganancia:"),t(),i(69,"span",80),a(70),b(71,"number"),t()()(),i(72,"div",81)(73,"button",82),g("click",function(){p(e);let r=d();return u(r.cerrarModalReceta())}),a(74," Cancelar "),t(),i(75,"button",83),a(76),t()()()()()()}if(o&2){let e=d();c(6),v("",e.receta.id?"Editar":"Agregar"," Receta"),c(6),w("ngModel",e.receta.nombre),c(9),v(" ",e.nuevaImagenFile?e.nuevaImagenFile.name:e.receta.imagen_url?"Cambiar imagen":"Haz clic para subir una imagen"," "),c(3),m("ngIf",e.previewImagenUrl||e.receta.imagen_url),c(4),w("ngModel",e.receta.precio_venta),c(5),w("ngModel",e.buscador),c(),m("ngIf",e.buscador),c(),m("ngIf",e.productosFiltrados.length>0),c(),m("ngIf",e.productosFiltrados.length===0),c(),m("ngIf",e.ingredienteSeleccionado),c(6),v(" Total: ",h(44,19,e.receta.precio_preparacion)," "),c(2),m("ngIf",e.receta.ingredientes.length>0),c(),m("ngIf",e.receta.ingredientes.length===0),c(6),f(h(53,21,e.receta.precio_preparacion)),c(6),f(h(59,23,e.receta.precio_venta||0)),c(6),f(h(65,25,e.receta.ganancia||0)),c(6),v("",M(71,27,e.receta.porcentajeGanancia||0,"1.0-2"),"%"),c(5),m("disabled",e.receta.ingredientes.length===0||!e.receta.nombre||!e.receta.precio_venta),c(),v(" ",e.receta.id?"Actualizar":"Guardar"," Receta ")}}function Ve(o,n){if(o&1){let e=y();i(0,"div",84)(1,"div",7),x(2,"img",155),i(3,"button",156),g("click",function(){p(e);let r=d(2);return u(r.eliminarImagen())}),x(4,"i",88),t()()()}if(o&2){let e=d(2);c(2),m("src",e.previewImagenUrl||e.receta.imagen_url,R)}}function Te(o,n){o&1&&(i(0,"tr")(1,"td",157),a(2,"No se encontraron ingredientes "),t()())}function Fe(o,n){if(o&1){let e=y();i(0,"tr",158)(1,"td",159)(2,"input",160),S("ngModelChange",function(r){p(e);let s=d(2);return C(s.ingredienteSeleccionado,r)||(s.ingredienteSeleccionado=r),u(r)}),t()(),i(3,"td",161),a(4),t(),i(5,"td",161),a(6),b(7,"currency"),t()()}if(o&2){let e=n.$implicit,l=d(2);B("bg-blue-50",(l.ingredienteSeleccionado==null?null:l.ingredienteSeleccionado.id)===e.id),c(2),m("value",e),w("ngModel",l.ingredienteSeleccionado),m("ngModelOptions",G(9,de)),c(2),f(e.nombre),c(2),v("",h(7,7,e.costo_unitario)," ")}}function Pe(o,n){if(o&1){let e=y();i(0,"li",164)(1,"div",165)(2,"span",103),a(3),t(),i(4,"input",166),S("ngModelChange",function(r){let s=p(e).$implicit;return C(s.cantidad,r)||(s.cantidad=r),u(r)}),g("ngModelChange",function(){p(e);let r=d(3);return u(r.calcularGanancia())}),t(),i(5,"span",167),a(6),b(7,"currency"),t(),i(8,"button",168),g("click",function(){let r=p(e).index,s=d(3);return u(s.eliminarIngrediente(r))}),a(9,"\u274C"),t()()()}if(o&2){let e=n.$implicit;c(3),f(e.nombre),c(),w("ngModel",e.cantidad),m("name","cantidad_"+e.producto_id),c(2),f(h(7,4,e.precio_unitario))}}function Be(o,n){if(o&1&&(i(0,"div",162)(1,"ul"),_(2,Pe,10,6,"li",163),t()()),o&2){let e=d(2);c(2),m("ngForOf",e.receta.ingredientes)}}function je(o,n){o&1&&(i(0,"div",169),a(1,"No hay ingredientes."),t())}function We(o,n){if(o&1){let e=y();i(0,"div",119)(1,"div",120)(2,"button",48),g("click",function(){p(e);let r=d();return u(r.cerrarModalEditarReceta())}),x(3,"i",49),t(),i(4,"div",50)(5,"h2",51),a(6,"Editar Receta"),t()(),i(7,"form",121),g("submit",function(){p(e);let r=d();return u(r.actualizarReceta())}),i(8,"div",122)(9,"label",123),a(10,"Nombre:"),t(),i(11,"input",124),S("ngModelChange",function(r){p(e);let s=d();return C(s.receta.nombre,r)||(s.receta.nombre=r),u(r)}),t(),i(12,"div",73)(13,"label",125),a(14,"Imagen de la receta"),t(),i(15,"div",126)(16,"input",127),g("change",function(r){p(e);let s=d();return u(s.onImagenChange(r))}),t(),i(17,"div",60),x(18,"i",61),i(19,"p",62),a(20),t(),i(21,"p",63),a(22,"Formatos: JPG, PNG (Max. 5MB)"),t()()(),_(23,Ve,5,1,"div",64),t(),i(24,"div",128)(25,"h3",129),a(26,"Agregar Ingrediente"),t(),i(27,"div",39)(28,"input",130),S("ngModelChange",function(r){p(e);let s=d();return C(s.buscador,r)||(s.buscador=r),u(r)}),g("input",function(){p(e);let r=d();return u(r.filtrarIngredientes())}),t()(),i(29,"div",131)(30,"table",132)(31,"thead",133)(32,"tr")(33,"th",134),a(34,"Seleccionar"),t(),i(35,"th",134),a(36,"Nombre"),t(),i(37,"th",134),a(38,"Precio Unitario"),t()()(),i(39,"tbody",135),_(40,Te,3,0,"tr",136)(41,Fe,8,10,"tr",137),t()()(),i(42,"div",138)(43,"div",103)(44,"label",139),a(45,"Cantidad"),t(),i(46,"input",140),S("ngModelChange",function(r){p(e);let s=d();return C(s.cantidadSeleccionada,r)||(s.cantidadSeleccionada=r),u(r)}),t()(),i(47,"button",141),g("click",function(){p(e);let r=d();return u(r.agregarIngrediente())}),a(48,"Agregar Ingrediente"),t()()(),i(49,"div",142)(50,"h3",143),a(51,"Ingredientes:"),t(),_(52,Be,3,1,"div",144)(53,je,2,0,"div",145),t(),i(54,"div",142)(55,"label",146),a(56,"Precio de Preparaci\xF3n:"),t(),x(57,"input",147),i(58,"div",142)(59,"label",148),a(60,"Precio de Venta:"),t(),i(61,"input",149),S("ngModelChange",function(r){p(e);let s=d();return C(s.receta.precio_venta,r)||(s.receta.precio_venta=r),u(r)}),g("ngModelChange",function(){p(e);let r=d();return u(r.calcularGanancia())}),t()(),i(62,"label",150),a(63,"Ganancia:"),t(),x(64,"input",151),t(),i(65,"div",152)(66,"button",153),g("click",function(){p(e);let r=d();return u(r.cerrarModalEditarReceta())}),a(67,"Cancelar"),t(),i(68,"button",154),a(69,"Guardar Cambios"),t()()()()()()}if(o&2){let e=d();c(11),w("ngModel",e.receta.nombre),c(9),v(" ",e.nuevaImagenFile?e.nuevaImagenFile.name:e.receta.imagen_url?"Imagen actual - Click para cambiar":"Haz clic para subir una imagen"," "),c(3),m("ngIf",e.previewImagenUrl||e.receta.imagen_url),c(5),w("ngModel",e.buscador),c(12),m("ngIf",e.productosFiltrados.length===0),c(),m("ngForOf",e.productosFiltrados),c(5),w("ngModel",e.cantidadSeleccionada),c(6),m("ngIf",e.receta.ingredientes.length>0),c(),m("ngIf",e.receta.ingredientes.length===0),c(4),m("value",e.receta.precio_preparacion),c(4),w("ngModel",e.receta.precio_venta),c(3),m("value",e.receta.ganancia)}}var T=class o{constructor(n){this.supabaseService=n}productos=[];productosFiltrados=[];buscador="";ingredienteSeleccionado=null;cantidadSeleccionada=1;recetaSeleccionada=null;productosDisponibles=[];receta={nombre:"",ingredientes:[],precio_preparacion:0,precio_venta:0,ganancia:0};recetas=[];recetaAEliminar=null;mostrarConfirmacionEliminar=!1;mostrarModalEditarReceta=!1;mostrarModalReceta=!1;cargando=!1;terminoBusquedaIngrediente="";productosFiltradosBusqueda=[];terminoBusquedaReceta="";recetasFiltradas=[];nuevaImagenFile;previewImagenUrl=null;ngOnInit(){return E(this,null,function*(){yield this.cargarProductos(),yield this.cargarRecetas()})}cargarProductos(){return E(this,null,function*(){try{this.cargando=!0;let n=yield this.supabaseService.obtenerProductos();this.productos=n.filter(e=>!e.eliminado),this.productosFiltrados=[...this.productos]}catch(n){console.error("Error cargando productos:",n)}finally{this.cargando=!1}})}abrirModalReceta(n){n?(this.receta=I({},n),this.previewImagenUrl=this.receta.imagen_url??null,this.nuevaImagenFile=void 0):this.resetearReceta(),this.mostrarModalReceta=!0}cerrarModalReceta(){this.mostrarModalReceta=!1,this.resetearReceta()}resetearReceta(){this.receta={nombre:"",ingredientes:[],precio_preparacion:0,precio_venta:0,ganancia:0},this.ingredienteSeleccionado=null,this.buscador="",this.productosFiltrados=[...this.productos]}filtrarIngredientes(){if(!this.buscador){this.productosFiltrados=[...this.productos];return}let n=this.buscador.toLowerCase();this.productosFiltrados=this.productos.filter(e=>e.nombre.toLowerCase().includes(n))}mostrarInputCantidad(n){this.ingredienteSeleccionado=n,this.cantidadSeleccionada=1}agregarIngrediente(){if(!this.ingredienteSeleccionado||this.cantidadSeleccionada<=0)return;let n=this.receta.ingredientes.findIndex(e=>e.producto_id===this.ingredienteSeleccionado?.id);n>=0?this.receta.ingredientes[n].cantidad+=this.cantidadSeleccionada:this.receta.ingredientes.push({producto_id:this.ingredienteSeleccionado.id,nombre:this.ingredienteSeleccionado.nombre,cantidad:this.cantidadSeleccionada,precio_unitario:this.ingredienteSeleccionado.costo_unitario}),this.calcularPrecioPreparacion(),this.calcularGanancia(),this.ingredienteSeleccionado=null}onIngredienteSeleccionado(){this.cantidadSeleccionada=1}calcularPrecioPreparacion(){if(!this.receta.ingredientes||this.receta.ingredientes.length===0){this.receta.precio_preparacion=0;return}this.receta.precio_preparacion=this.receta.ingredientes.reduce((n,e)=>n+e.precio_unitario*e.cantidad,0)}guardarReceta(){return E(this,null,function*(){if(!(this.receta.ingredientes.length===0||!this.receta.nombre))try{this.cargando=!0,this.calcularPrecioPreparacion();let n={nombre:this.receta.nombre,ingredientes:this.receta.ingredientes,precio_preparacion:this.receta.precio_preparacion,imagen_url:this.receta.imagen_url,precio_venta:this.receta.precio_venta,ganancia:this.receta.ganancia};this.receta.id?yield this.supabaseService.actualizarReceta(this.receta.id,n,this.nuevaImagenFile):yield this.supabaseService.agregarReceta(n,this.nuevaImagenFile),this.cerrarModalReceta(),this.mostrarMensajeExito(),yield this.cargarRecetas(),this.nuevaImagenFile=void 0}catch(n){console.error("Error guardando receta:",n),this.mostrarMensajeError()}finally{this.cargando=!1}})}mostrarMensajeExito(){k.default.fire({title:"\xA1\xC9xito!",text:"La receta se ha guardado correctamente.",icon:"success",confirmButtonText:"Aceptar",timer:2e3})}mostrarMensajeError(){k.default.fire({title:"Error",text:"Hubo un problema al guardar la receta. Intenta nuevamente.",icon:"error",confirmButtonText:"Aceptar"})}onImagenChange(n){let e=n.target;if(e.files&&e.files[0]){this.nuevaImagenFile=e.files[0];let l=new FileReader;l.onload=r=>{this.previewImagenUrl=r.target?.result},l.readAsDataURL(this.nuevaImagenFile)}}eliminarImagen(){this.previewImagenUrl=null,this.nuevaImagenFile=void 0,this.receta.imagen_url&&(this.receta.imagen_url=null)}cargarRecetas(){return E(this,null,function*(){try{this.cargando=!0,this.recetas=yield this.supabaseService.obtenerRecetas(),this.recetas=this.recetas.map(n=>V(I({},n),{ingredientes:typeof n.ingredientes=="string"?JSON.parse(n.ingredientes):n.ingredientes})),this.recetas.forEach(n=>{n.precio_preparacion&&n.precio_venta?n.porcentajeGanancia=(n.precio_venta-n.precio_preparacion)/n.precio_venta*100:n.porcentajeGanancia=0}),this.filtrarRecetas()}catch(n){console.error("Error cargando recetas:",n)}finally{this.cargando=!1}})}filtrarRecetas(){if(!this.terminoBusquedaReceta){this.recetasFiltradas=[...this.recetas];return}let n=this.terminoBusquedaReceta.toLowerCase();this.recetasFiltradas=this.recetas.filter(e=>e.nombre.toLowerCase().includes(n))}confirmarEliminarReceta(n){this.recetaAEliminar=n,this.mostrarConfirmacionEliminar=!0}eliminarReceta(){return E(this,null,function*(){if(this.recetaAEliminar)try{this.cargando=!0,yield this.cargarRecetas()}catch(n){console.error("Error eliminando receta:",n)}finally{this.cargando=!1,this.mostrarConfirmacionEliminar=!1,this.recetaAEliminar=null}})}seleccionarReceta(n){this.recetaSeleccionada=I({},n)}abrirModalEditarReceta(n){this.receta=V(I({},n),{ingredientes:n.ingredientes.map(e=>I({},e))}),this.mostrarModalEditarReceta=!0,this.calcularPrecioPreparacion(),this.calcularGanancia()}eliminarIngrediente(n){this.receta.ingredientes.splice(n,1),this.calcularPrecioPreparacion()}cerrarModalEditarReceta(){this.mostrarModalEditarReceta=!1,this.limpiarCamposIngredientes()}actualizarReceta(){return E(this,null,function*(){if(!(!this.receta.nombre||this.receta.ingredientes.length===0||!this.receta.id))try{this.cargando=!0,this.calcularPrecioPreparacion(),yield this.supabaseService.actualizarReceta(this.receta.id,this.receta,this.nuevaImagenFile),k.default.fire({icon:"success",title:"\xA1Receta actualizada!",showConfirmButton:!1,timer:1500}),yield this.cargarRecetas(),this.calcularGanancia(),this.limpiarCamposIngredientes(),this.terminoBusquedaReceta="",this.cerrarModalEditarReceta(),this.nuevaImagenFile=void 0}catch(n){console.error("Error actualizando receta:",n)}finally{this.cargando=!1}})}limpiarCamposIngredientes(){this.buscador="",this.ingredienteSeleccionado=null,this.cantidadSeleccionada=1,this.filtrarIngredientes()}calcularGanancia(){this.calcularPrecioPreparacion(),this.receta.precio_venta&&this.receta.precio_venta>0?(this.receta.ganancia=this.receta.precio_venta-this.receta.precio_preparacion,this.receta.porcentajeGanancia=this.receta.ganancia/this.receta.precio_preparacion*100):(this.receta.ganancia=0,this.receta.porcentajeGanancia=0)}static \u0275fac=function(e){return new(e||o)(F(re))};static \u0275cmp=P({type:o,selectors:[["app-recetas"]],decls:20,vars:4,consts:[[1,"container","mx-auto","p-6"],[1,"mb-8","text-center"],[1,"text-3xl","font-bold","text-black","mb-2"],[1,"text-gray-600"],[1,"w-24","h-1","bg-orange-500","mx-auto","mt-4"],[1,"flex","flex-col","md:flex-row","justify-between","gap-4","mb-8"],[1,"w-full","md:w-1/2"],[1,"relative"],["type","text","placeholder","Buscar receta por nombre","id","search-recipe","name","searchRecipe",1,"w-full","p-3","pl-10","border","border-gray-300","rounded-lg","shadow-sm","focus:outline-none","focus:ring-2","focus:ring-orange-500","focus:border-transparent","transition",3,"ngModelChange","input","ngModel"],[1,"fas","fa-search","absolute","left-3","top-1/2","transform","-translate-y-1/2","text-gray-400"],[1,"bg-orange-500","hover:bg-orange-600","text-white","p-3","rounded-lg","shadow-md","transition","duration-300","flex","items-center","justify-center","space-x-2","cursor-pointer",3,"click"],[1,"fas","fa-plus"],["id","recipes-list",1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-3","gap-6","mt-6"],["class","bg-white p-6 rounded-lg shadow-lg border border-gray-100 hover:shadow-xl transition duration-300 transform hover:-translate-y-1 mb-6",4,"ngFor","ngForOf"],["class","fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm px-2",4,"ngIf"],["class","fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm px-4",4,"ngIf"],[1,"bg-white","p-6","rounded-lg","shadow-lg","border","border-gray-100","hover:shadow-xl","transition","duration-300","transform","hover:-translate-y-1","mb-6"],[1,"flex","justify-between","items-center","mb-4"],[1,"text-xl","font-bold","text-black"],[1,"flex","space-x-2"],["title","Editar",1,"text-orange-500","hover:text-orange-600","cursor-pointer",3,"click"],[1,"fas","fa-edit"],["class","mb-4",4,"ngIf"],[1,"bg-white","rounded-lg","overflow-hidden","border","border-gray-200"],[1,"w-full","text-xs","md:text-base"],[1,"bg-black","text-white"],[1,"py-1","px-2","text-left"],["class","border-b border-gray-200",3,"ngClass",4,"ngFor","ngForOf"],[1,"bg-yellow-50"],["colspan","2",1,"py-1","px-2","text-right","font-bold","text-black"],[1,"py-1","px-2","font-bold","text-black"],[1,"mt-4","text-sm","text-gray-500","space-y-4"],[1,"flex","justify-between","items-center"],[1,"font-medium","text-gray-700"],[1,"font-semibold","text-gray-800"],[1,"font-semibold","text-green-600"],[1,"font-semibold","text-lg",3,"ngClass"],["class","text-sm text-green-600",4,"ngIf"],["class","text-sm text-red-600",4,"ngIf"],[1,"mb-4"],[1,"w-full","h-48","object-cover","rounded-lg",3,"src","alt"],[1,"border-b","border-gray-200",3,"ngClass"],[1,"py-1","px-2"],[1,"text-sm","text-green-600"],[1,"font-bold"],[1,"text-sm","text-red-600"],[1,"fixed","inset-0","z-50","flex","items-center","justify-center","bg-black/60","backdrop-blur-sm","px-2"],[1,"bg-white","text-black","rounded-xl","w-full","max-w-3xl","shadow-2xl","border","border-yellow-600","relative","max-h-[90vh]","flex","flex-col","overflow-hidden"],["title","Cerrar",1,"absolute","top-3","right-3","text-black","bg-orange-500","hover:bg-orange-600","rounded-full","w-8","h-8","flex","items-center","justify-center","transition","duration-200","cursor-pointer",3,"click"],[1,"bi","bi-x-lg","text-base"],[1,"bg-white","text-black","px-4","py-4","flex","items-center","justify-between","border-b","border-yellow-500"],[1,"text-lg","font-semibold"],[1,"overflow-y-auto",3,"submit"],[1,"px-4","py-3","bg-white","space-y-4"],[1,"space-y-1"],["for","nombre",1,"block","text-gray-700","font-medium"],["type","text","id","nombre","name","nombre","required","","placeholder","Ej: Pizza Margarita",1,"w-full","mt-1","p-2","border","rounded","focus:ring-2","focus:ring-amber-500","focus:border-amber-500",3,"ngModelChange","ngModel"],[1,"block","text-gray-700","font-medium"],[1,"relative","border-2","border-dashed","border-gray-300","rounded-lg","p-4","mt-1","hover:border-amber-400","transition-colors"],["type","file","id","imagenReceta","accept","image/*","title","imagen",1,"absolute","inset-0","w-full","h-full","opacity-0","cursor-pointer",3,"change"],[1,"text-center"],[1,"bi","bi-image","text-3xl","text-gray-400"],[1,"mt-2","text-sm","text-gray-600"],[1,"text-xs","text-gray-500","mt-1"],["class","mt-2 flex justify-center",4,"ngIf"],["for","precioVenta",1,"block","text-gray-700","font-medium"],["type","number","id","precioVenta","name","precioVenta","required","","placeholder","Ej: 15.00",1,"w-full","mt-1","p-2","border","rounded","focus:ring-2","focus:ring-amber-500","focus:border-amber-500",3,"ngModelChange","ngModel"],["for","buscarIngrediente",1,"block","text-gray-700","font-medium"],["type","text","name","buscador","placeholder","Escribe para buscar ingredientes...",1,"w-full","mt-1","p-2","border","rounded","focus:ring-2","focus:ring-amber-500","focus:border-amber-500",3,"ngModelChange","input","ngModel"],["class","absolute right-3 top-3 text-gray-400 hover:text-gray-600 cursor-pointer",3,"click",4,"ngIf"],["class","max-h-60 overflow-y-auto mt-2 p-2 border rounded bg-gray-50 space-y-2",4,"ngIf"],["class","text-center text-gray-500 py-4",4,"ngIf"],["class","mt-4 p-3 bg-amber-50 rounded-lg border border-amber-200",4,"ngIf"],[1,"mt-4"],[1,"text-gray-700","font-medium"],[1,"text-sm","font-medium"],["class","bg-gray-100 p-2 mt-2 border rounded",4,"ngIf"],["class","text-center text-gray-500 py-4 border border-dashed rounded mt-2",4,"ngIf"],[1,"mt-4","space-y-2","bg-amber-50","p-3","rounded","border","border-amber-200"],[1,"text-sm","font-medium","text-green-600"],[1,"text-sm","font-medium","text-blue-600"],[1,"mt-6","flex","justify-between","border-t","pt-4"],["type","button",1,"px-5","py-2","bg-gray-300","text-black","rounded-lg","hover:bg-gray-400","transition","cursor-pointer",3,"click"],["type","submit",1,"px-5","py-2","bg-amber-600","text-white","rounded-lg","hover:bg-amber-500","transition","disabled:bg-amber-300","disabled:cursor-not-allowed","cursor-pointer",3,"disabled"],[1,"mt-2","flex","justify-center"],["alt","Vista previa de la receta",1,"max-h-40","rounded-lg","border","border-gray-200","object-cover",3,"src"],["type","button","class","absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-600","title","ver",3,"click",4,"ngIf"],["type","button","title","ver",1,"absolute","-top-2","-right-2","bg-red-500","text-white","rounded-full","w-6","h-6","flex","items-center","justify-center","hover:bg-red-600",3,"click"],[1,"bi","bi-x","text-sm"],[1,"absolute","right-3","top-3","text-gray-400","hover:text-gray-600","cursor-pointer",3,"click"],[1,"bi","bi-x-lg"],[1,"max-h-60","overflow-y-auto","mt-2","p-2","border","rounded","bg-gray-50","space-y-2"],["class","flex items-center justify-between p-2 hover:bg-gray-100 rounded",4,"ngFor","ngForOf"],[1,"flex","items-center","justify-between","p-2","hover:bg-gray-100","rounded"],[1,"flex","items-center","space-x-3"],[1,"text-sm","text-gray-500"],["type","button",1,"px-3","py-1","bg-blue-500","text-white","rounded","hover:bg-blue-600","transition","duration-200","disabled:bg-gray-300","disabled:cursor-not-allowed","cursor-pointer",3,"click","disabled"],[1,"text-center","text-gray-500","py-4"],[1,"mt-4","p-3","bg-amber-50","rounded-lg","border","border-amber-200"],[1,"flex","items-center","justify-between","mb-2"],[1,"font-medium"],["type","button","title","cerrar",1,"text-gray-500","hover:text-gray-700","cursor-pointer",3,"click"],[1,"flex","items-center","space-x-4"],[1,"flex-1"],[1,"block","text-gray-700","text-sm","mb-1"],["type","number","name","cantidadSeleccionada","min","1","placeholder","Cantidad","required","",1,"w-full","p-2","border","rounded",3,"ngModelChange","ngModel","max"],["type","button",1,"mt-5","px-4","py-2","bg-green-500","text-white","rounded","hover:bg-green-600","transition","duration-200","cursor-pointer",3,"click"],["class","text-xs text-gray-500 mt-1",4,"ngIf"],["class","text-xs text-red-500 mt-1",4,"ngIf"],[1,"text-xs","text-red-500","mt-1"],[1,"bg-gray-100","p-2","mt-2","border","rounded"],[1,"divide-y","divide-gray-200"],["class","py-2 flex justify-between items-center",4,"ngFor","ngForOf"],[1,"py-2","flex","justify-between","items-center"],[1,"text-sm","text-gray-500","ml-2"],[1,"flex","items-center","space-x-2"],["type","button","title","Eliminar",1,"text-red-500","hover:text-red-700",3,"click"],[1,"bi","bi-trash"],[1,"text-center","text-gray-500","py-4","border","border-dashed","rounded","mt-2"],[1,"fixed","inset-0","z-50","flex","items-center","justify-center","bg-black/60","backdrop-blur-sm","px-4"],[1,"bg-white","text-black","rounded-xl","w-full","max-w-4xl","shadow-2xl","border","border-yellow-600","relative","max-h-[90vh]","flex","flex-col","overflow-hidden"],[3,"submit"],[1,"px-4","py-3","bg-white","overflow-y-auto","flex-1","max-h-[75vh]"],["for","nombre",1,"block","text-gray-700","font-semibold"],["type","text","id","nombre","name","nombre","required","","placeholder","Nombre de la receta",1,"w-full","mt-1","p-2","border","rounded-lg",3,"ngModelChange","ngModel"],[1,"block","text-gray-700","font-semibold","mb-1"],[1,"relative","border-2","border-dashed","border-gray-300","rounded-lg","p-4","hover:border-amber-400","transition-colors"],["type","file","id","imagenEditarReceta","accept","image/jpeg, image/png","title","imagen",1,"absolute","inset-0","w-full","h-full","opacity-0","cursor-pointer",3,"change"],[1,"mt-6","bg-gray-50","p-4","rounded-lg","border","border-gray-300"],[1,"text-gray-700","font-semibold","mb-3"],["type","text","placeholder","Buscar ingrediente...","name","buscarIngrediente",1,"w-full","p-3","border","rounded-lg",3,"ngModelChange","input","ngModel"],[1,"max-h-60","overflow-y-auto","mb-4","border","rounded-lg"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-50","sticky","top-0"],[1,"px-4","py-2","text-left","text-xs","font-medium","text-gray-500","uppercase"],[1,"bg-white","divide-y","divide-gray-200"],[4,"ngIf"],["class","hover:bg-gray-50 cursor-pointer",3,"bg-blue-50",4,"ngFor","ngForOf"],[1,"flex","flex-col","sm:flex-row","gap-3","items-end","mb-4"],["for","cantidadIngrediente",1,"block","text-sm","text-gray-600","mb-1"],["type","number","id","cantidadIngrediente","name","cantidadIngrediente","min","1","placeholder","Cantidad",1,"w-full","p-2","border","rounded-lg",3,"ngModelChange","ngModel"],["type","button",1,"px-5","py-2","bg-green-500","text-white","rounded-lg","hover:bg-green-600","transition",3,"click"],[1,"mt-6"],[1,"text-gray-700","font-semibold"],["class","bg-gray-100 p-4 mt-2 border rounded-lg",4,"ngIf"],["class","text-gray-500 mt-2",4,"ngIf"],["for","precio_preparacion",1,"block","text-gray-700"],["type","number","readonly","","title","Precio preparaci\xF3n",1,"w-full","mt-1","p-2","border","rounded-lg","bg-gray-100",3,"value"],["for","precio_venta",1,"block","text-gray-700","mt-4"],["type","number","name","precio_venta","title","Precio de venta",1,"w-full","mt-1","p-2","border","rounded-lg",3,"ngModelChange","ngModel"],["for","ganancia",1,"block","text-gray-700","mt-4"],["type","number","readonly","","title","Ganancia",1,"w-full","mt-1","p-2","border","rounded-lg","bg-gray-100",3,"value"],[1,"mt-6","flex","justify-between","gap-4"],["type","button",1,"px-6","py-3","bg-gray-300","text-black","rounded-lg","hover:bg-gray-400","transition","cursor-pointer",3,"click"],["type","submit",1,"px-6","py-3","bg-amber-600","text-white","rounded-lg","hover:bg-amber-500","transition","cursor-pointer"],["title","imagen",1,"max-h-40","rounded-lg","border","border-gray-200","object-cover",3,"src"],["type","button","title","imagen",1,"absolute","-top-2","-right-2","bg-red-500","text-white","rounded-full","w-6","h-6","flex","items-center","justify-center","hover:bg-red-600",3,"click"],["colspan","3",1,"px-4","py-2","text-center","text-sm","text-gray-500"],[1,"hover:bg-gray-50","cursor-pointer"],[1,"px-4","py-2","whitespace-nowrap"],["type","radio","name","ingredienteSeleccionado","title","s",1,"h-4","w-4","text-blue-600","focus:ring-blue-500","border-gray-300",3,"ngModelChange","value","ngModel","ngModelOptions"],[1,"px-4","py-2","whitespace-nowrap","text-sm","text-gray-900"],[1,"bg-gray-100","p-4","mt-2","border","rounded-lg"],["class","flex justify-between items-center py-2",4,"ngFor","ngForOf"],[1,"flex","justify-between","items-center","py-2"],[1,"flex","items-center","space-x-2","w-full"],["type","number","min","1","title","Cantidad del ingrediente",1,"w-20","p-1","border","rounded-lg","text-center",3,"ngModelChange","ngModel","name"],[1,"flex-1","text-right"],["type","button","title","Eliminar ingrediente",1,"text-red-500","hover:text-red-600","cursor-pointer",3,"click"],[1,"text-gray-500","mt-2"]],template:function(e,l){e&1&&(i(0,"div",0)(1,"div",1)(2,"h2",2),a(3,"Gesti\xF3n de Recetas"),t(),i(4,"p",3),a(5,"Administra tus recetas, ingredientes y costos"),t(),x(6,"div",4),t(),i(7,"div",5)(8,"div",6)(9,"div",7)(10,"input",8),S("ngModelChange",function(s){return C(l.terminoBusquedaReceta,s)||(l.terminoBusquedaReceta=s),s}),g("input",function(){return l.filtrarRecetas()}),t(),x(11,"i",9),t()(),i(12,"button",10),g("click",function(){return l.abrirModalReceta()}),x(13,"i",11),i(14,"span"),a(15,"Agregar Receta"),t()()(),i(16,"div",12),_(17,ge,48,21,"div",13),t()(),_(18,ke,77,30,"div",14)(19,We,70,12,"div",15)),e&2&&(c(10),w("ngModel",l.terminoBusquedaReceta),c(7),m("ngForOf",l.recetasFiltradas),c(),m("ngIf",l.mostrarModalReceta),c(),m("ngIf",l.mostrarModalEditarReceta))},dependencies:[D,z,A,L,q,U,ne,Y,H,Z,$,J,K,ie,te,ee,X,Q],styles:[".eliminar-ingrediente[_ngcontent-%COMP%]{color:red;background:none;border:none;cursor:pointer;font-size:18px;transition:color .2s ease-in-out}.eliminar-ingrediente[_ngcontent-%COMP%]:hover{color:#ff4747}"]})};export{T as default};
